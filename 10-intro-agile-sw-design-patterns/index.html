<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
<title>Progettazione e Sviluppo del Software</title>
<meta name="description" content="Progettazione e Sviluppo del Software, Tecnologie dei Sistemi Informatici">
<meta name="author" content="Danilo Pianini">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><link rel="stylesheet" href="/reveal-js/dist/reset.css">
<link rel="stylesheet" href="/reveal-js/dist/reveal.css">
  <link rel="stylesheet" href="/css/custom-theme.min.64b25e8fc79cb2d6ebd4c0f19d110cd870679489e26e7e2cf19b4b743498a84c.css" id="theme"><link rel="stylesheet" href="/highlight-js/default.min.css">
<link href="https://fonts.googleapis.com/css?family=Roboto Mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Oxygen Mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Ubuntu Mono" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  </head>
  <body>
    
    <div class="reveal">
      <div class="slides">
  

    <section><h1 id="introduzione-alla-progettazione-efficace-ed-agile-del-software">Introduzione alla progettazione efficace ed agile del software</h1>
<h4 id="progettazione-e-sviluppo-del-software">Progettazione e Sviluppo del Software</h4>
<h4 id="cdl-tecnologie-dei-sistemi-informatici">C.D.L. Tecnologie dei Sistemi Informatici</h4>
<h3 id="roberto-casadei-----robycasadeiuniboitmailtorobycasadeiuniboit"><a href="mailto:roby.casadei@unibo.it">Roberto Casadei — <code>roby.casadei@unibo.it</code></a></h3>
<h3 id="angelo-filaseta-----angelofilasetauniboitmailtoangelofilasetauniboit"><a href="mailto:angelo.filaseta@unibo.it">Angelo Filaseta — <code>angelo.filaseta@unibo.it</code></a></h3>
<h3 id="gianluca-aguzzi-----gianlucaaguzziuniboitmailtogianlucaaguzziuniboit"><a href="mailto:gianluca.aguzzi@unibo.it">Gianluca Aguzzi — <code>gianluca.aguzzi@unibo.it</code></a></h3>
<!-- ### [Luca DeLuigi --- `luca.deluigi5@unibo.it`](mailto:luca.deluigi5@unibo.it) -->
<p><a href="?print-pdf&amp;pdfSeparateFragments=false"><i class="fa fa-print" aria-hidden="true"></i> versione stampabile</a></p>
</section><section>
<h2 id="outline">Outline</h2>
<h3 id="goal-della-lezione">Goal della lezione</h3>
<ul>
<li>Riassumere i concetti, principi, meccanismi visti in precedenza</li>
<li>Introdurre le basi della <em>progettazione del software</em></li>
<li>Introdurre le basi dell’<em>agile</em></li>
<li>Mostrare alcune applicazioni notevoli (<em>pattern</em>) dei concetti, principi, e meccanismi OO visti in precedenza</li>
</ul>
<h3 id="argomenti">Argomenti</h3>
<ul>
<li>Introduzione ai <em>design pattern</em></li>
<li><em>Architettura</em> e <em>design di dettaglio</em></li>
<li><em>Agile software development</em>: cos’è, manifesto, principi</li>
<li>Pattern <em>Strategy</em></li>
</ul>
</section><section>
<h2 id="riassunto-delle-puntate-precedenti">Riassunto delle puntate precedenti</h2>
<h3 id="elementi-di-progettazione-di-sistemi-software-oo">Elementi di progettazione di sistemi software (OO)</h3>
<ul>
<li>Programma vs. sistema software</li>
<li>Fasi processo di sviluppo: analisi $\to$ design $\to$ implementazione $\to$ collaudo $\to$ deployment</li>
<li>Problem space (dominio/logica business) vs. solution space (scelte realizzative)
<ul>
<li>concetto di <em>astrazione</em> e di “livello di astrazione”</li>
</ul>
</li>
<li>Riuso mediante
<ul>
<li>utilizzo di altri oggetti (<em>composizione</em>)</li>
<li>estensione dei servizi offerti da altri oggetti (<em>ereditarietà</em>)</li>
</ul>
</li>
<li>Concetti di modularità, dipendenza, accoppiamento, coesione</li>
<li>Metodologie
<ul>
<li><em>test-driven development</em></li>
</ul>
</li>
</ul>
</section><section>
<h3 id="strumenti">Strumenti</h3>
<ul>
<li>Java 17
<ul>
<li><em>write once, run everywhere</em></li>
<li><strong>JDK</strong>: JRE (JVM [<code>java</code>] + JCL) + strumenti di sviluppo (<code>javac</code>, <code>jshell</code> …)</li>
</ul>
</li>
<li><em>Terminali</em> per l’accesso al file system e ai programmi da linea di comando</li>
<li>Strumenti JDK: compilazione con <code>javac</code> ed esecuzione con <code>java</code>
<ul>
<li>concetto di <em>classpath</em></li>
</ul>
</li>
<li><code>gradle</code>: build system
<ul>
<li>plugin <code>java</code>, e blocco <code>dependencies</code></li>
</ul>
</li>
<li><code>git</code>: version control system</li>
<li><code>JUnit</code>: framework per lo unit testing</li>
<li><em>Visual Studio Code</em>: ambiente di sviluppo integrato (IDE)</li>
</ul>
</section><section>
<h3 id="java-elementi-di-base">Java: elementi di base</h3>
<ul>
<li>Elementi di base
<ul>
<li>programmazione strutturata/imperativa (C-like)</li>
<li><em>programma</em>: metodo pubblico statico <code>main</code> in classe pubblica</li>
<li><em>tipi primitivi vs. tipi oggetto</em> (classi/interfacce)</li>
<li>variabili contengono i <em>riferimenti</em> ad oggetti (allocati nello <em>heap</em>)
<ul>
<li>assegnamento per copia del riferimento</li>
</ul>
</li>
<li>oggetti allocati in memoria dinamica (heap) $\to$ lifetime di oggetti va oltre lo scope
<ul>
<li>no deallocazione manuale (cf. <em>GC</em>)</li>
</ul>
</li>
</ul>
</li>
</ul>
</section><section>
<h3 id="basi-delloop-in-java">Basi dell’OOP in Java</h3>
<ul>
<li>Astrazione object-oriented
<ul>
<li><em>oggetto = stato + comportamento + identità</em> (cf. <em>incapsulamento</em>)
<ul>
<li>interazione attraverso “scambio di messaggi” (in realtà: chiamate sincrone a metodi)</li>
</ul>
</li>
<li><em>classe</em> come “tipo” di oggetti e come “template” di costruzione di oggetti simili (<em>istanze</em>)</li>
<li><em>interfaccia</em> vs. implementazione (cf. <em>information-hiding</em>)</li>
</ul>
</li>
<li>Costrutti
<ul>
<li>dichiarazione <code>class</code>: contiene dichiarazione <em>campi</em>, <em>metodi</em> (statici o d’istanza), e costruttori</li>
<li>uso di oggetti: accesso a proprietà (metodi/campi) mediante <em>dot notation</em>
<ul>
<li>concetto di <em>receiver</em> di una <em>method call</em> e variabile speciale <code>this</code></li>
</ul>
</li>
<li>dichiarazione <code>interface</code></li>
<li>modificatore <code>static</code> per codice <em>statico</em> (metodi/campi <em>di classe</em>)</li>
<li><em>costruttori</em> e inizializzazione di oggetti</li>
<li><em>overloading</em> di metodi e costruttori</li>
<li><em>package</em> come namespace e contenitori di classi (cf. dichiarazione <code>package</code>) organizzati gerarchicamente
<ul>
<li><em>FQCN (Fully-Qualified Class Name)</em></li>
<li><code>import</code> per importare i nomi delle classi in scope</li>
</ul>
</li>
<li><em>controllo di accesso</em>: <code>public</code>, package-private, <code>private</code></li>
<li>modificatore <code>final</code> per campi e variabili <em>costanti</em> (non modificabili)</li>
</ul>
</li>
</ul>
</section><section>
<h3 id="oop-efficace">OOP efficace</h3>
<ul>
<li><em>Linee guida stilistiche</em> di formattazione di sorgenti Java (spaziature, nomi, etc.)</li>
<li><strong>Incapsulamento</strong>
<ol>
<li>impacchettamento <em>dati</em> e <em>funzioni</em> per la loro manipolazione</li>
<li><em>information hiding</em>: interfaccia pubblica stabile (<em>contratto</em>) e dettagli implementativi privati</li>
</ol>
</li>
<li>Uso <strong>interfacce</strong> per catturare astrazioni e contratti</li>
<li>Varie
<ul>
<li>metodi getter e setter</li>
<li>oggetti <em>immutabili</em></li>
</ul>
</li>
</ul>
<p>Competenza attuale attesa: costruzione di piccoli progetti software Java/Gradle, tracciati con controllo di versione (git), che realizzano ed esercitano (mediante programmi e test JUnit) semplici sistemi ad oggetti ben incapsulati</p>
</section><section>
<h1 id="introduzione-alla-progettazione-del-software">Introduzione alla progettazione del software</h1>
</section><section>
<h2 id="richiamo-qualità-interna-vs-esterna">Richiamo: qualità interna vs. esterna</h2>
<h3 id="qualità-esterna----aspetti-funzionali">Qualità <em>esterna</em> – aspetti <em>funzionali</em></h3>
<ul>
<li>Realizza correttamente il suo compito</li>
<li>In termini di quali funzionalità fornisce</li>
</ul>
<h3 id="qualità-esterna----aspetti-non-funzionali">Qualità <em>esterna</em> – aspetti <em>non-funzionali</em></h3>
<ul>
<li>Performance adeguate (alle specifiche)</li>
<li>Uso efficiente/adeguato delle risorse del sistema (memoria, CPU)</li>
<li>Caratteristiche di sicurezza, affidabilità, usabilità, etc..</li>
</ul>
<h3 id="qualità-interna----software-ben-costruito">Qualità <em>interna</em> – software ben costruito</h3>
<ul>
<li>Facilmente manutenibile (leggibile, flessibile, riusabile)
<ul>
<li>quindi: meno “costoso”, a breve-/medio-/lungo-termine</li>
</ul>
</li>
</ul>
</section><section>
<h3 id="come-promuovere-la-qualità-interna-del-software">Come promuovere la qualità interna del software?</h3>
<ul>
<li>Regole di stile e formattazione dei sorgenti</li>
<li>Principi e tecniche di programmazione/progettazione efficace</li>
<li>Uso di pratiche come il TDD</li>
</ul>
<h3 id="il-problema-della-progettazione">Il problema della <strong>progettazione</strong></h3>
<ul>
<li>Come organizzare in modo efficace un sistema OO (classi, interfacce, e relazioni tra queste) per ottenere la funzionalità e la qualità esterna desiderate?</li>
</ul>
</section><section>
<h2 id="progettazione-del-software">Progettazione del software</h2>
<h3 id="architettura">Architettura</h3>
<ul>
<li><strong>Architettura del software</strong>: descrizione dei componenti principali e delle relazioni importanti tra questi</li>
<li>esempio:
<ul>
<li>una applicazione <code>Calcolatrice</code> consiste in 3 componenti principali:
<ol>
<li>interfaccia grafica (GUI)</li>
<li>componente che realizza i calcoli matematici</li>
<li>controller: parte che richiede i calcoli a fronte delle azioni dell’utente e chiede alla GUI di visualizzare il risultato</li>
</ol>
</li>
</ul>
</li>
<li>approfondiremo questa parte più avanti</li>
</ul>
<h3 id="progettazione-di-dettaglio">Progettazione di dettaglio</h3>
<ul>
<li>La <strong>progettazione di dettaglio</strong> descrive relazioni fra un insieme coeso di (tipi di) oggetti
<ul>
<li>le relazioni più significative di un particolare sottosistema</li>
<li>non descrive ogni singola classe/interfaccia del sistema</li>
</ul>
</li>
<li>documentata da più diagrammi UML di 5-10 classi ognuno</li>
</ul>
</section><section>
<h1 id="agile-software-development">Agile software development</h1>
<h2 id="introduzione">Introduzione</h2>
<p>Il software è il risultato di un <em>processo di sviluppo</em></p>
<ul>
<li>Processi, pratiche, e strumenti incidono sulla qualità del software</li>
</ul>
<p>Qui introduciamo una famiglia di processi e pratiche nota con il termine <strong>agile</strong></p>
</section><section>
<h2 id="agile-software-development-sviluppo-agile-del-software">Agile software development (sviluppo agile del software)</h2>
<ul>
<li>Lo <strong>sviluppo agile del software</strong> è un insieme di principi, pratiche, e metodi volti a <em>rispondere al cambiamento</em>
<ul>
<li>cambiamento della comprensione del problema, dei requisiti, delle risorse…</li>
</ul>
</li>
<li>Si basa su approcci <em>iterativi/incrementali</em> a <em>cicli brevi</em> per <em>feedback frequente</em>, con focus su <em>qualità</em> attraverso pratiche/strumenti quali refactoring, pattern, …</li>
</ul>
<h3 id="manifesto">Manifesto</h3>
<p><a href="https://agilemanifesto.org/">https://agilemanifesto.org/</a></p>
<p>“Stiamo scoprendo modi migliori di creare software,
sviluppandolo e aiutando gli altri a fare lo stesso.
Grazie a questa attività siamo arrivati a considerare importanti:</p>
<ol>
<li>Gli <strong>individui e le interazioni</strong> più che i <em>processi e gli strumenti</em></li>
<li>Il <strong>software funzionante</strong> più che la <em>documentazione esaustiva</em></li>
<li>La <strong>collaborazione col cliente</strong> più che la <em>negoziazione dei contratti</em></li>
<li><strong>Rispondere al cambiamento</strong> più che <em>seguire un piano</em></li>
</ol>
<p>Ovvero, fermo restando il valore delle voci a destra,
consideriamo più importanti le voci a sinistra.”</p>
</section><section>
<h3 id="agile-principi-1-12">Agile: principi 1-12</h3>
<ol>
<li>La nostra massima priorità è soddisfare il cliente
rilasciando software di valore, fin da subito
e in maniera continua.</li>
<li><em>Accogliamo i cambiamenti nei requisiti,
anche a stadi avanzati dello sviluppo.
I processi agili sfruttano il cambiamento
a favore del vantaggio competitivo del cliente.</em></li>
<li>Consegnamo frequentemente software funzionante,
con cadenza variabile da un paio di settimane a un paio di mesi,
preferendo i periodi brevi.</li>
<li>Committenti e sviluppatori devono lavorare insieme
quotidianamente per tutta la durata del progetto.</li>
<li>Fondiamo i progetti su individui motivati.
Diamo loro l’ambiente e il supporto di cui hanno bisogno
e confidiamo nella loro capacità di portare il lavoro a termine.</li>
<li>Una conversazione faccia a faccia
è il modo più efficiente e più efficace per comunicare
con il team ed all’interno del team.</li>
<li><em>Il software funzionante è il principale metro di misura di progresso.</em></li>
<li>I processi agili promuovono uno sviluppo sostenibile.
Gli sponsor, gli sviluppatori e gli utenti dovrebbero essere in grado
di mantenere indefinitamente un ritmo costante.</li>
<li><em>La continua attenzione all’eccellenza tecnica
e alla buona progettazione esaltano l’agilità.</em></li>
<li>La semplicità - l’arte di massimizzare la quantità
di lavoro non svolto - è essenziale.</li>
<li>Le architetture, i requisiti e la progettazione
migliori emergono da team che si auto-organizzano.</li>
<li>A intervalli regolari il team riflette su come
diventare più efficace, dopodiché regola e adatta
il proprio comportamento di conseguenza.</li>
</ol>
</section><section>
<h1 id="design-pattern-e-progettazione-di-dettaglio">Design Pattern e Progettazione di Dettaglio</h1>
</section><section>
<h2 id="come-progettare-una-buona-classe-o-gruppo-di-classi">Come progettare una buona classe o gruppo di classi?</h2>
<ul>
<li>buona conoscenza della <em>programmazione OO</em>
<ul>
<li>incapsulamento, information hiding</li>
<li>polimorfismo</li>
<li>ereditarietà (che vedremo)</li>
</ul>
</li>
<li>buona conoscenza di <em>principi e pratiche di progettazione/programmazione efficace</em>
<ul>
<li>DRY (Don’t Repeat Yourself), …</li>
<li>astrazione attraverso interfacce, tecniche di riuso (composizione), …</li>
</ul>
</li>
<li>utilizzo di cataloghi noti di pattern di progettazione (<em>design pattern</em>)</li>
</ul>
</section><section>
<h2 id="design-pattern">Design Pattern</h2>
<h3 id="i-pattern-di-progettazione">I Pattern di progettazione</h3>
<ul>
<li>Un <strong>pattern</strong> è una <em>soluzione notevole a problemi ricorrenti di design object-oriented</em>
 <!-- elementi riusabili (semplici ed eleganti) di progettazione OO -->
<ul>
<li>I problemi di “design” sono spesso ricorrenti</li>
<li>Progettisti esperti hanno nel tempo affrontato tali problemi, provato diverse soluzioni, fino ad ottenere soluzioni efficaci con chiara analisi di costi/benefici</li>
<li>Tale “esperienza” è stata codificata in forma generica/riusabile in “pattern” che possono essere applicati in contesti simili</li>
</ul>
</li>
<li>Alcuni sono particolarmente famosi, come quelli della <em>“Gang of Four”</em> (detti anche <em>Pattern GoF</em>)
<ul>
<li>Testo famosissimo (in C++): <em>Design Patterns: Elements of Reusable Object-Oriented Software</em> di <em>E. Gamma, R. Helm, R. Johnson, J. Vlissides</em></li>
<li>23 in tutto. Esempi: Strategy, Decorator, Singleton, Template Method, Observer</li>
<li>(Cit. “SW di grosse dimensioni li usano praticamente tutti”)</li>
</ul>
</li>
<li>Benefici
<ul>
<li>Il loro uso migliora molto il codice
<ul>
<li>Rende il codice più flessibile (nascono per questo)</li>
<li>Portano più direttamente ad una buona organizzazione (delle responsabilità, delle dipendenze, etc.)</li>
</ul>
</li>
<li>Fanno parte di un “vocabolario” per la comunicazione fra programmatori/progettisti</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="design-pattern-in-questa-sede">Design Pattern in questa sede</h2>
<h3 id="nel-corso">Nel corso</h3>
<ul>
<li>E’ importante imparare quelli che introdurremo</li>
<li>E’ opportuno applicarli nel progetto d’esame (e documentarli nella relazione)</li>
</ul>
<h3 id="per-il-vostro-futuro">Per il vostro futuro</h3>
<ul>
<li>Noi porremo le basi per uno loro studio in autonomia</li>
<li>Un ottimo progettista li conosce e usa (ove opportuno) <em><strong>tutti</strong></em></li>
</ul>
</section><section>
<h2 id="motivazione-qualità-interna-refactoring-agilità">Motivazione: qualità interna, refactoring, agilità</h2>
<ul>
<li>E’ importante conoscere e cercare di applicare i pattern in quanto:
<ul>
<li>promuovono la <em>qualità interna</em> del software</li>
<li>promuovono l’<em>agilità</em> attraverso software di qualità</li>
<li>permettono di velocizzare l’attività di <em>refactoring</em></li>
</ul>
</li>
</ul>
</section><section>
<h3 id="rifattorizzazione-refactoring">Rifattorizzazione (<strong>refactoring</strong>)</h3>
<ul>
<li>Operazione di modifica del codice che <em>non aggiunge funzionalità</em></li>
<li>Ha lo scopo di <em>migliorare la qualità interna del SW</em>
<ul>
<li>la sua formattazione, la sua espressività semantica (cf. nomenclatura), la sua struttura</li>
</ul>
</li>
<li>Ha lo scopo di attrezzare il codice a possibili cambiamenti futuri (cf. <em>agilità</em>)
<ul>
<li>Può/deve quindi comportare una riprogettazione di alcune parti</li>
</ul>
</li>
<li>Il refactoring è una pratica necessaria
<ul>
<li>Una buona progettazione non la si ottiene al primo “colpo”, ma richiede vari refactoring</li>
<li>Brian Foote identifica tre fasi nello sviluppo di un sistema: “prototyping”, “expansionary”, “consolidating”; nel consolidamento si rifattorizza</li>
</ul>
</li>
</ul>
<h3 id="il-refactoring-è-supportato-da-test-e-pattern">Il refactoring è supportato da test e pattern</h3>
<ul>
<li>I <em>test automatici</em> permettono di verificare se un refactoring ha introdotto regressioni</li>
<li>I <em>design pattern</em> forniscono direttamente “ricette” di buona costruzione o rifattorizzazione del SW</li>
</ul>
<!--

### Agilità

* Si vuole rendere il software *agile*, ovvero in grado di rispondere facilmente al cambiamento (nuovi requisiti, ...)
*  Nell'*agile programming*, ogni ciclo di sviluppo non parte se non si è rifattorizzato il codice del ciclo precedente (sia in cicli corti che lunghi) 

-->
</section><section>
<h2 id="struttura-di-un-pattern">Struttura di un “pattern”</h2>
<h3 id="un-pattern-ha-quattro-elementi-fondamentali">Un Pattern ha quattro elementi fondamentali</h3>
<ol>
<li>Un <strong>nome</strong>.
<ul>
<li>È un aspetto fondamentale! Entra a far parte di un <em>vocabolario</em></li>
</ul>
</li>
<li>Un <strong>problema</strong> che risolve.
<ul>
<li>La causa che porta al suo uso</li>
<li>Include il <em>contesto</em> di applicazione del pattern</li>
</ul>
</li>
<li>La <strong>soluzione</strong> che propone.
<ul>
<li>gli <em>elementi</em> del design e le loro <em>responsabilità</em>, <em>relazioni</em> con altri elementi, e <em>collaborazioni</em></li>
</ul>
</li>
<li>La <strong>conseguenza</strong> che porta.
<ul>
<li><em>risultati</em> e <em>vincoli</em> (ad es. in termini di riuso, variabilità, performance, …)</li>
<li>il risultato è spesso un <em>trade-off</em></li>
<li>la scelta di applicare un pattern è questione di <em>costi-benefici</em></li>
</ul>
</li>
</ol>
<!--
    
### Granularità

*  Gruppo ristretto di (1-5) oggetti/classi generali dipendenti fra loro
*  Sistemi più specifici o più complessi sono utili, ma non propriamente dei "Pattern"
    *  Non singole classi riusabili (liste, hash-table)
    *  Non "pattern architetturali" (come MVC)
    *  Non framework complessi (gerarchia Swing, Reflection)
	
-->
</section><section>
<h2 id="classificazione-dei-pattern-categorie">Classificazione dei Pattern: categorie</h2>
<h3 id="livello-proposito-del-pattern">Livello “proposito del Pattern”</h3>
<ul>
<li><strong>Creazionali</strong>: Riguardano la creazione degli oggetti</li>
<li><strong>Strutturali</strong>: Riguardano la composizione di classi/oggetti</li>
<li><strong>Comportamentali</strong>: Riguardano la interazione e distribuzione di responsabilità fra classi/oggetti</li>
</ul>
<h3 id="livello-scope">Livello “scope”</h3>
<ul>
<li><strong>Classi</strong>: Il Pattern riguarda primariamente le relazioni fra classi (e sottoclassi), e quindi tratta aspetti <em>statici</em> (compile-time)</li>
<li><strong>Oggetti</strong>: Il Pattern riguarda primariamente le relazioni fra oggetti (l’esistenza di riferimenti fra oggetti), e quindi tratta aspetti <em>dinamici</em> (run-time)</li>
</ul>
</section><section>
<h2 id="i-23-pattern-gof">I 23 Pattern GoF</h2>
<h3 id="creazionali">Creazionali</h3>
<ul>
<li>A livello di classe: <em><strong>Factory Method</strong></em></li>
<li>A livello di oggetto: <em><strong>Abstract Factory</strong></em>, <em><strong>Builder</strong></em>, Prototype, <em><strong>Singleton</strong></em></li>
</ul>
<h3 id="strutturali">Strutturali</h3>
<ul>
<li>A livello di classe: <em><strong>Adapter</strong></em></li>
<li>A livello di oggetto: <em><strong>Adapter</strong></em>, Bridge, Composite, <em><strong>Decorator</strong></em>, Facade, Proxy</li>
</ul>
<h3 id="comportamentali">Comportamentali</h3>
<ul>
<li>A livello di classe: Interpreter, <em><strong>Template Method</strong></em></li>
<li>A livello di oggetto: Chain of Responsibility, Command, <em><strong>Iterator</strong></em>, Mediator, Memento, Flyweight, <em><strong>Observer</strong></em>, State, <em><strong>Strategy</strong></em>, <em><strong>Visitor</strong></em></li>
</ul>
</section><section>
<h2 id="schema-di-descrizione-per-ogni-pattern">Schema di descrizione per ogni pattern</h2>
<p>Aderiremo al seguente schema, che è una semplificazione di quello proposto alla GoF</p>
<h3 id="ingredienti">Ingredienti</h3>
<ul>
<li>Descrizione in prosa (nome, motivazione, esempi, soluzione)</li>
<li>Rappresentazione grafica (diagramma delle classi generale)</li>
<li>Esempio (già visto/nuovo)</li>
</ul>
<!--

## I pattern nel corso

    
### Esami di progetto


*  Identificarne/usarne "pochi" è considerato poco soddisfacente
*  Scegliere di usarli non è arbitario, ma è indice di buona progettazione e/o di buona rifattorizzazione
*  Gli argomenti: "in questo progetto non servivano" e "non c'è stato tempo" sono pessimi
*  Argomento di probabile discussione all'esame

    
### Di conseguenza



*  I pattern qui presentati vanno conosciuti
*  Gli altri pattern sono facoltativi, e importanti per il vostro futuro
    

-->
</section><section>
<h1 id="alcuni-pattern-iniziali">Alcuni pattern iniziali</h1>
</section><section>
<h2 id="strategy-comportamentale-su-oggetti">Strategy: comportamentale, su oggetti</h2>
<h3 id="intentomotivazione">Intento/motivazione</h3>
<p>Definisce una famiglia di algoritmi, e li rende interscambiabili, ossia usabili in modo trasparente dai loro clienti</p>
<h3 id="esempi">Esempi</h3>
<ul>
<li>Strategie di confronto fra due elementi per sorting (<code>Comparable</code>)</li>
<li>Strategia di disposizione di componenti in una GUI (<code>LayoutManager</code>)</li>
<li>Strategie di <code>map</code>, <code>filter</code>, etc.. negli <code>Stream</code></li>
</ul>
<h3 id="soluzione">Soluzione</h3>
<ul>
<li>Gli algoritmi sono realizzati tramite specializzazioni di una classe/interfaccia base</li>
<li>Ai clienti passo un oggetto (di una specializzazione) dell’interfaccia base</li>
</ul>
<!-- *  Se la strategia è funzionale si usano facilmente le lambda (e viceversa) -->
<p><em><strong>È probabilmente uno dei pattern più importanti (assieme al Factory Methods)</strong></em></p>
</section><section>
<h2 id="strategy-uml">Strategy: UML</h2>
<!-- ![](imgs/strategy.jpg) -->
<p><img src="imgs/pattern-strategy.png" alt=""></p>
</section><section>
<h2 id="strategy-sorting-con-comparatori">Strategy: Sorting con comparatori</h2>
<!--    \sizedrangedcode{\ssmall}{5}{100}{\ecl/strategy/UseComparator.java} -->
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">interface</span> <span style="color:#3f6e75">PersonCompareStrategy</span> <span style="color:#000">{</span>	
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">int</span> <span style="color:#000">compareTwoPeople</span><span style="color:#000">(</span><span style="color:#000">Person</span> <span style="color:#000">p1</span><span style="color:#000">,</span> <span style="color:#000">Person</span> <span style="color:#000">p2</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></section><section>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">PersonComparatorByAge</span> <span style="color:#a90d91">implements</span> <span style="color:#000">PersonCompareStrategy</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">compareTwoPeople</span><span style="color:#000">(</span><span style="color:#000">Person</span> <span style="color:#000">p1</span><span style="color:#000">,</span> <span style="color:#000">Person</span> <span style="color:#000">p2</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#000">p1</span><span style="color:#000">.</span><span style="color:#836c28">getYearOfBirth</span><span style="color:#000">()</span> <span style="color:#000">&lt;</span> <span style="color:#000">p2</span><span style="color:#000">.</span><span style="color:#836c28">getYearOfBirth</span><span style="color:#000">()</span> <span style="color:#000">?</span> <span style="color:#000">-</span><span style="color:#000">1</span> <span style="color:#000">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">(</span><span style="color:#000">p1</span><span style="color:#000">.</span><span style="color:#836c28">getYearOfBirth</span><span style="color:#000">()</span> <span style="color:#000">==</span> <span style="color:#000">p2</span><span style="color:#000">.</span><span style="color:#836c28">getYearOfBirth</span><span style="color:#000">()</span> <span style="color:#000">?</span> <span style="color:#000">0</span> <span style="color:#000">:</span> <span style="color:#000">+</span><span style="color:#000">1</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>	
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">PersonComparatorByFullName</span> <span style="color:#a90d91">implements</span> <span style="color:#000">PersonCompareStrategy</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">compareTwoPeople</span><span style="color:#000">(</span><span style="color:#000">Person</span> <span style="color:#000">p1</span><span style="color:#000">,</span> <span style="color:#000">Person</span> <span style="color:#000">p2</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">fullName1</span> <span style="color:#000">=</span> <span style="color:#000">p1</span><span style="color:#000">.</span><span style="color:#836c28">getSurname</span><span style="color:#000">()</span> <span style="color:#000">+</span> <span style="color:#000">p1</span><span style="color:#000">.</span><span style="color:#836c28">getName</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">String</span> <span style="color:#000">fullName2</span> <span style="color:#000">=</span> <span style="color:#000">p2</span><span style="color:#000">.</span><span style="color:#836c28">getSurname</span><span style="color:#000">()</span> <span style="color:#000">+</span> <span style="color:#000">p2</span><span style="color:#000">.</span><span style="color:#836c28">getName</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#000">fullName1</span><span style="color:#000">.</span><span style="color:#836c28">compareTo</span><span style="color:#000">(</span><span style="color:#000">fullName2</span><span style="color:#000">);</span> <span style="color:#177500">// reuse compareTo on String
</span></span></span><span style="display:flex;"><span><span style="color:#177500"></span>    <span style="color:#000">}</span>	
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></section><section>
<div class="smaller">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UsePersons</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">sortPeople</span><span style="color:#000">(</span><span style="color:#000">Person</span><span style="color:#000">[]</span> <span style="color:#000">ps</span><span style="color:#000">,</span> <span style="color:#000">PersonCompareStrategy</span> <span style="color:#000">comparator</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">boolean</span> <span style="color:#000">sorted</span> <span style="color:#000">=</span> <span style="color:#a90d91">false</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">while</span><span style="color:#000">(!</span><span style="color:#000">sorted</span><span style="color:#000">){</span> <span style="color:#177500">// bubble sort
</span></span></span><span style="display:flex;"><span><span style="color:#177500"></span>            <span style="color:#000">sorted</span> <span style="color:#000">=</span> <span style="color:#a90d91">true</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">for</span><span style="color:#000">(</span><span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">0</span><span style="color:#000">;</span> <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">ps</span><span style="color:#000">.</span><span style="color:#836c28">length</span><span style="color:#000">-</span><span style="color:#000">1</span><span style="color:#000">;</span> <span style="color:#000">i</span><span style="color:#000">++)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a90d91">if</span><span style="color:#000">(</span><span style="color:#000">comparator</span><span style="color:#000">.</span><span style="color:#836c28">compareTwoPeople</span><span style="color:#000">(</span><span style="color:#000">ps</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">],</span> <span style="color:#000">ps</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">+</span><span style="color:#000">1</span><span style="color:#000">])</span> <span style="color:#000">&gt;</span> <span style="color:#000">0</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">Person</span> <span style="color:#000">temp</span> <span style="color:#000">=</span> <span style="color:#000">ps</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">];</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">ps</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">]</span> <span style="color:#000">=</span> <span style="color:#000">ps</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">+</span><span style="color:#000">1</span><span style="color:#000">];</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">ps</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">+</span><span style="color:#000">1</span><span style="color:#000">]</span> <span style="color:#000">=</span> <span style="color:#000">temp</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">sorted</span> <span style="color:#000">=</span> <span style="color:#a90d91">false</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">printPeople</span><span style="color:#000">(</span><span style="color:#000">Person</span><span style="color:#000">[]</span> <span style="color:#000">people</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">for</span><span style="color:#000">(</span><span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">0</span><span style="color:#000">;</span> <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">people</span><span style="color:#000">.</span><span style="color:#836c28">length</span><span style="color:#000">;</span> <span style="color:#000">i</span><span style="color:#000">++)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span><span style="color:#000">.</span><span style="color:#836c28">out</span><span style="color:#000">.</span><span style="color:#836c28">println</span><span style="color:#000">(</span><span style="color:#c41a16">""</span> <span style="color:#000">+</span> <span style="color:#000">i</span> <span style="color:#000">+</span> <span style="color:#c41a16">") "</span> <span style="color:#000">+</span> <span style="color:#000">people</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">].</span><span style="color:#836c28">getName</span><span style="color:#000">()</span> <span style="color:#000">+</span> <span style="color:#c41a16">" "</span> <span style="color:#000">+</span> <span style="color:#000">people</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">].</span><span style="color:#836c28">getSurname</span><span style="color:#000">()</span> <span style="color:#000">+</span> 
</span></span><span style="display:flex;"><span>                <span style="color:#c41a16">" - "</span> <span style="color:#000">+</span> <span style="color:#000">people</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">].</span><span style="color:#836c28">getYearOfBirth</span><span style="color:#000">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span><span style="color:#000">(</span><span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span><span style="color:#000">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Person</span> <span style="color:#000">p1</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Person</span><span style="color:#000">(</span><span style="color:#c41a16">"Mario"</span><span style="color:#000">,</span> <span style="color:#c41a16">"Rossi"</span><span style="color:#000">,</span> <span style="color:#000">1985</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Person</span> <span style="color:#000">p2</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Person</span><span style="color:#000">(</span><span style="color:#c41a16">"Dario"</span><span style="color:#000">,</span> <span style="color:#c41a16">"Verdi"</span><span style="color:#000">,</span> <span style="color:#000">1970</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Person</span> <span style="color:#000">p3</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Person</span><span style="color:#000">(</span><span style="color:#c41a16">"Zarco"</span><span style="color:#000">,</span> <span style="color:#c41a16">"Neri"</span><span style="color:#000">,</span> <span style="color:#000">1952</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Person</span><span style="color:#000">[]</span> <span style="color:#000">people</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Person</span><span style="color:#000">[]</span> <span style="color:#000">{</span> <span style="color:#000">p1</span><span style="color:#000">,</span> <span style="color:#000">p2</span><span style="color:#000">,</span> <span style="color:#000">p3</span> <span style="color:#000">};</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">sortPeople</span><span style="color:#000">(</span><span style="color:#000">people</span><span style="color:#000">,</span> <span style="color:#a90d91">new</span> <span style="color:#000">PersonComparatorByAge</span><span style="color:#000">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">printPeople</span><span style="color:#000">(</span><span style="color:#000">people</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span><span style="color:#000">.</span><span style="color:#836c28">out</span><span style="color:#000">.</span><span style="color:#836c28">println</span><span style="color:#000">(</span><span style="color:#c41a16">"\n"</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">sortPeople</span><span style="color:#000">(</span><span style="color:#000">people</span><span style="color:#000">,</span> <span style="color:#a90d91">new</span> <span style="color:#000">PersonComparatorByFullName</span><span style="color:#000">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">printPeople</span><span style="color:#000">(</span><span style="color:#000">people</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></div>
</section><section>
<h3 id="esempio-uml">Esempio: UML</h3>
<div class="container">
<div class="col">
<p><img src="imgs/pattern-strategy.png" alt=""></p>
</div>
<div class="col">
<p><img src="imgs/pattern-strategy-example.png" alt=""></p>
</div>
</div>
</section><section>
<h3 id="analisi">Analisi</h3>
<div class="container">
<div class="col">
<p><img src="imgs/pattern-strategy-example.png" alt=""></p>
</div>
<div class="col">
<ul>
<li><code>UsePersons</code> è il <em>contesto</em> della strategia</li>
<li><code>UsePersons</code> vuole ordinare un array di <code>Person</code>, ma <em>astrae</em> dalla strategia impiegata per il confronto</li>
<li><code>UsePersons</code> si occupa di fornire il <em>sotto-contesto</em> alla strategia, che in questo caso è dato da una coppia di <code>Person</code> da confrontare</li>
<li>Le diverse implementazioni della strategia usano il sotto-contesto diversamente: <code>PersonComparatorByFullName</code> si basa su nome/cognome, mentre <code>PersonComparatorByAge</code> si basa sull’anno di nascita</li>
<li>Il design è <em>aperto</em> all’introduzione di altre strategie (ad esempio: in base a tratti fisici come l’altezza), ma <em>il contesto rimarrà invariato</em>!</li>
</ul>
</div>
</div>
</section><section>
<h2 id="i-pattern-factory">I pattern “factory”</h2>
<ul>
<li>I pattern <strong>“factory”</strong> caratterizzano delle organizzazioni di codice OO al fine di gestire il modo con cui viene stabilito <em>quali classi istanziare</em>
<ul>
<li>2 pattern semplici: <strong>Static Factory</strong> e <strong>Simple Factory</strong></li>
<li>2 pattern GOF: <strong>Abstract Factory</strong>, <strong>Factory Method</strong></li>
<li>Varie varianti sono possibili…</li>
<li>…Noi ne illustreremo una che è a metà tra Abstract Factory e Factory Method</li>
<li>…Che può essere anche vista come un’applicazione dello <strong>Strategy</strong> dove strategie concrete stabiliscono quali classi istanziare</li>
</ul>
</li>
</ul>
</section><section>
<h3 id="esempio-motivante-simplelamp-advancedlamp-twolampsdevice">Esempio motivante: <code>SimpleLamp</code>, <code>AdvancedLamp</code>, <code>TwoLampsDevice</code></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">interface</span> <span style="color:#3f6e75">Lamp</span> <span style="color:#000">{</span>	
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">void</span> <span style="color:#000">switchOn</span><span style="color:#000">();</span>       
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">void</span> <span style="color:#000">switchOff</span><span style="color:#000">();</span>	   
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">boolean</span> <span style="color:#000">isSwitchedOn</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">void</span> <span style="color:#000">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">interface</span> <span style="color:#3f6e75">AdvancedLamp</span> <span style="color:#a90d91">extends</span> <span style="color:#000">Lamp</span> <span style="color:#000">{</span>	
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">dim</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">brighten</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">setIntensity</span><span style="color:#000">(</span><span style="color:#a90d91">int</span> <span style="color:#000">level</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">TwoLampsDevice</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Lamp</span> <span style="color:#000">lamp1</span><span style="color:#000">,</span> <span style="color:#000">lamp2</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">TwoLampsDevice</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">lamp1</span> <span style="color:#000">=</span> <span style="color:#177500">/* ??? */</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">lamp2</span> <span style="color:#000">=</span> <span style="color:#177500">/* ??? */</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></section><section>
<div class="smaller">
<div class="container">
<div class="col">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">SimpleLampImpl</span> <span style="color:#a90d91">implements</span> <span style="color:#000">Lamp</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">private</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">switchedOn</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#000">SimpleLampImpl</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span> <span style="color:#000">=</span> <span style="color:#a90d91">false</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOn</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span> <span style="color:#000">=</span> <span style="color:#a90d91">true</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOff</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span> <span style="color:#000">=</span> <span style="color:#a90d91">false</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">isSwitchedOn</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">toString</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>	   <span style="color:#a90d91">return</span> <span style="color:#c41a16">"LAMP["</span> <span style="color:#000">+</span> <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">isSwitchedOn</span><span style="color:#000">()</span> <span style="color:#000">+</span> <span style="color:#c41a16">"]"</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">ecoMode</span><span style="color:#000">()</span> <span style="color:#000">{</span> <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></div>
<div class="col">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">AdvancedLampImpl</span> <span style="color:#a90d91">implements</span> <span style="color:#000">AdvancedLamp</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">final</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">int</span> <span style="color:#000">MIN_INTENSITY</span> <span style="color:#000">=</span> <span style="color:#000">1</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">final</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">int</span> <span style="color:#000">MAX_INTENSITY</span> <span style="color:#000">=</span> <span style="color:#000">10</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">private</span> <span style="color:#a90d91">int</span> <span style="color:#000">intensity</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">private</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">switchedOn</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#000">AdvancedLampImpl</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span> <span style="color:#000">=</span> <span style="color:#a90d91">false</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">intensity</span> <span style="color:#000">=</span> <span style="color:#000">(</span><span style="color:#000">MIN_INTENSITY</span> <span style="color:#000">+</span> <span style="color:#000">MAX_INTENSITY</span><span style="color:#000">)</span> <span style="color:#000">/</span> <span style="color:#000">2</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOn</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span> <span style="color:#000">=</span> <span style="color:#a90d91">true</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOff</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span> <span style="color:#000">=</span> <span style="color:#a90d91">false</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">isSwitchedOn</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">switchedOn</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">setIntensity</span><span style="color:#000">(</span><span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">i</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">intensity</span> <span style="color:#000">=</span> <span style="color:#000">i</span> <span style="color:#000">&gt;</span> <span style="color:#000">MAX_INTENSITY</span> <span style="color:#000">?</span> <span style="color:#000">MAX_INTENSITY</span> <span style="color:#000">:</span>
</span></span><span style="display:flex;"><span>         <span style="color:#000">(</span><span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">MIN_INTENSITY</span> <span style="color:#000">?</span> <span style="color:#000">MIN_INTENSITY</span> <span style="color:#000">:</span> <span style="color:#000">i</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">dim</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">setIntensity</span><span style="color:#000">(</span><span style="color:#000">getIntensity</span><span style="color:#000">()</span> <span style="color:#000">-</span> <span style="color:#000">1</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">brighten</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">setIntensity</span><span style="color:#000">(</span><span style="color:#000">getIntensity</span><span style="color:#000">()</span> <span style="color:#000">+</span> <span style="color:#000">1</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">ecoMode</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000">setIntensity</span><span style="color:#000">(</span><span style="color:#000">MIN_INTENSITY</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>   <span style="color:#000">}</span>
</span></span></code></pre></div></div>
</div>
</div>
</section><section>
<div class="container">
<div class="col">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">TwoLampsDeviceNaive</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#000">Lamp</span> <span style="color:#000">l1</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#000">Lamp</span> <span style="color:#000">l2</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">TwoLampsDeviceNaive</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">SimpleLampImpl</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">AdvancedLampImpl</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOnBoth</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">switchOn</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">switchOn</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOffBoth</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">switchOff</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">switchOff</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">ecoMode</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">toString</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">return</span> <span style="color:#c41a16">"{"</span> <span style="color:#000">+</span> <span style="color:#000">l1</span> <span style="color:#000">+</span> <span style="color:#c41a16">"; "</span> <span style="color:#000">+</span> <span style="color:#000">l2</span> <span style="color:#000">+</span> <span style="color:#c41a16">"}"</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></div>
<div class="col">
<ul>
<li>In questo esempio, <code>TwoLampsDeviceNaive</code> prende subito una decisione sulle <code>Lamp</code> concrete da comporre</li>
<li>Idealmente però, la nostra <code>TwoLampsDevice</code> dovrebbe astrarre dall’implementazione concreta delle <code>Lamp</code>
<ul>
<li>potrebbe consistere di due <code>SimpleLamp</code>, di due <code>AdvancedLamp</code>, o di un mix delle due..</li>
</ul>
</li>
<li>Obiettivo: rifattorizzare per
<ol>
<li>rendere <code>TwoLampsDevice</code> più <strong>generale</strong> (<em>supportare varie composizioni</em>)</li>
<li><em>eliminare la <strong>dipendenza</strong> dalle classi concrete</em></li>
<li><em>rimuovere (spostare altrove) la <strong>responsabilità</strong> di scegliere le implementazioni concrete</em></li>
</ol>
</li>
</ul>
</div>
</div>
</section><section>
<h3 id="static-factory">Static Factory</h3>
<div class="smaller">
<div class="container">
<div class="col">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">TwoLampsDeviceWithStaticFactory</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#000">Lamp</span> <span style="color:#000">l1</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#000">Lamp</span> <span style="color:#000">l2</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">TwoLampsDeviceWithStaticFactory</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span> <span style="color:#000">=</span> <span style="color:#000">LampFactoryModule</span><span style="color:#000">.</span><span style="color:#836c28">createLamp</span><span style="color:#000">(</span><span style="color:#a90d91">false</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span> <span style="color:#000">=</span> <span style="color:#000">LampFactoryModule</span><span style="color:#000">.</span><span style="color:#836c28">createLamp</span><span style="color:#000">(</span><span style="color:#a90d91">true</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOnBoth</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">switchOn</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">switchOn</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOffBoth</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">switchOff</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">switchOff</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">ecoMode</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span></code></pre></div></div>
<div class="col">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">LampFactoryModule</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">Lamp</span> <span style="color:#000">createLamp</span><span style="color:#000">(</span><span style="color:#a90d91">boolean</span> <span style="color:#000">advanced</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#000">advanced</span> <span style="color:#000">?</span> <span style="color:#000">createAdvancedLamp</span><span style="color:#000">()</span> <span style="color:#000">:</span> <span style="color:#000">createSimpleLamp</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">AdvancedLamp</span> <span style="color:#000">createAdvancedLamp</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">new</span> <span style="color:#000">AdvancedLampImpl</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">Lamp</span> <span style="color:#000">createSimpleLamp</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">new</span> <span style="color:#000">SimpleLampImpl</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseTwoLampsDeviceWithStaticFactory</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span><span style="color:#000">(</span><span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">TwoLampsDeviceWithStaticFactory</span> <span style="color:#000">td</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">TwoLampsDeviceWithStaticFactory</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">td</span><span style="color:#000">.</span><span style="color:#836c28">switchOnBoth</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#000">.</span><span style="color:#836c28">out</span><span style="color:#000">.</span><span style="color:#836c28">println</span><span style="color:#000">(</span><span style="color:#000">td</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">td</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#000">.</span><span style="color:#836c28">out</span><span style="color:#000">.</span><span style="color:#836c28">println</span><span style="color:#000">(</span><span style="color:#000">td</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></div>
</div>
</div>
<p>Benefici dei <em>metodi factory statici</em> (rispetto ad uso diretto dei costruttori)</p>
<ul>
<li>possono restituire oggetti di qualunque sottotipo del tipo di ritorno</li>
<li>la classe da istanziare può variare a seconda dei parametri</li>
<li>possono avere nomi espressivi a piacere</li>
<li>permettono di superare la limitazione di poter avere un solo costruttore per una data signature</li>
</ul>
</section><section>
<h3 id="simple-factory">Simple Factory</h3>
<ul>
<li>Come Static Factory, ma il metodo è non statico e in una classe separata (anche chiamata <em>classe factory</em>)</li>
</ul>
<h3 id="altra-soluzione">Altra soluzione</h3>
<ul>
<li>Elementi della soluzione
<ul>
<li>Si introduce un’<em>interfaccia</em> per le possibili <em>factory</em></li>
<li>Si inietta la factory concreta in un <em>contesto</em> ove occorre</li>
<li>Il contesto diventa riusabile rispetto a diverse factory (e quindi diversi prodotti istanziabili)</li>
</ul>
</li>
</ul>
</section><section>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">interface</span> <span style="color:#3f6e75">LampFactory</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">Lamp</span> <span style="color:#000">createLamp</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">SimpleLampFactory</span> <span style="color:#a90d91">implements</span> <span style="color:#000">LampFactory</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">Lamp</span> <span style="color:#000">createLamp</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">new</span> <span style="color:#000">SimpleLampImpl</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">AdvancedLampFactory</span> <span style="color:#a90d91">implements</span> <span style="color:#000">LampFactory</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">Lamp</span> <span style="color:#000">createLamp</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">new</span> <span style="color:#000">AdvancedLampImpl</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></section><section>
<div class="container">
<div class="col">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">TwoLampsDevice</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#000">Lamp</span> <span style="color:#000">l1</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#000">Lamp</span> <span style="color:#000">l2</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">TwoLampsDevice</span><span style="color:#000">(</span><span style="color:#000">LampFactory</span> <span style="color:#000">f</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span> <span style="color:#000">=</span> <span style="color:#000">f</span><span style="color:#000">.</span><span style="color:#836c28">createLamp</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span> <span style="color:#000">=</span> <span style="color:#000">f</span><span style="color:#000">.</span><span style="color:#836c28">createLamp</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOnBoth</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">switchOn</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">switchOn</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">switchOffBoth</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">switchOff</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">switchOff</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">ecoMode</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l1</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span><span style="color:#000">.</span><span style="color:#836c28">l2</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">toString</span><span style="color:#000">()</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">return</span> <span style="color:#c41a16">"{"</span> <span style="color:#000">+</span> <span style="color:#000">l1</span> <span style="color:#000">+</span> <span style="color:#c41a16">"; "</span> <span style="color:#000">+</span> <span style="color:#000">l2</span> <span style="color:#000">+</span> <span style="color:#c41a16">"}"</span><span style="color:#000">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></div>
<div class="col">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseTwoLampsDevice</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">testWith</span><span style="color:#000">(</span><span style="color:#000">LampFactory</span> <span style="color:#000">lf</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">TwoLampsDevice</span> <span style="color:#000">td</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">TwoLampsDevice</span><span style="color:#000">(</span><span style="color:#000">lf</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">td</span><span style="color:#000">.</span><span style="color:#836c28">switchOnBoth</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#000">.</span><span style="color:#836c28">out</span><span style="color:#000">.</span><span style="color:#836c28">println</span><span style="color:#000">(</span><span style="color:#000">td</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">td</span><span style="color:#000">.</span><span style="color:#836c28">ecoMode</span><span style="color:#000">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span><span style="color:#000">.</span><span style="color:#836c28">out</span><span style="color:#000">.</span><span style="color:#836c28">println</span><span style="color:#000">(</span><span style="color:#000">td</span><span style="color:#000">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span><span style="color:#000">(</span><span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span><span style="color:#000">)</span> <span style="color:#000">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">testWith</span><span style="color:#000">(</span><span style="color:#a90d91">new</span> <span style="color:#000">SimpleLampFactory</span><span style="color:#000">());</span> 
</span></span><span style="display:flex;"><span>		<span style="color:#000">testWith</span><span style="color:#000">(</span><span style="color:#a90d91">new</span> <span style="color:#000">AdvancedLampFactory</span><span style="color:#000">());</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000">}</span>
</span></span></code></pre></div></div>
</div>
</section><section>
<ul>
<li>Benefici
<ul>
<li><code>TwoLampsDevice</code> può comporsi con diverse coppie di lampadine e lavorare con esse in modo uniforme senza dover variare il proprio codice (cf. polimorfismo)</li>
<li><code>TwoLampsDevice</code> non dipende più da classi concrete, ma da oggetti di contratto <code>LampFactory</code></li>
</ul>
</li>
<li>Un pattern tra Abstract Factory e Factory Method
<ul>
<li>Propriamente, Abstract Factory dovrebbe supportare una <em>famiglia di prodotti</em></li>
<li>Propriamente, Factory Method richiederebbe che le classi che specializzano il metodo factory riusino il contesto</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="preview-del-prossimo-laboratorio">Preview del prossimo laboratorio</h2>
<ul>
<li>Consolidare l’uso di interfacce e composizione</li>
<li>Sperimentare con pattern Strategy e Factory</li>
</ul>
</section>

  


</div>
      

    </div>
<script type="text/javascript" src="/reveal-hugo/object-assign.js"></script>

<a href="/reveal-js/dist/print/" id="print-location" style="display: none;"></a>

<script type="application/json" id="reveal-hugo-site-params">{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"custom_theme_options":{"enablesourcemap":true,"targetpath":"css/custom-theme.css"},"height":"900","highlight_theme":"default","history":true,"mermaid":[{"startOnLoad":false}],"slide_number":true,"theme":"white","transition":"slide","transition_speed":"fast","width":"1440"}</script>
<script type="application/json" id="reveal-hugo-page-params">null</script>

<script src="/reveal-js/dist/reveal.js"></script>


  
  
  <script type="text/javascript" src="/reveal-js/plugin/markdown/markdown.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/highlight/highlight.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/zoom/zoom.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/notes/notes.js"></script>
  
  
  <script type="text/javascript" src="/reveal-js/plugin/notes/notes.js"></script>




<script type="text/javascript">
  
  
  function camelize(map) {
    if (map) {
      Object.keys(map).forEach(function(k) {
        newK = k.replace(/(\_\w)/g, function(m) { return m[1].toUpperCase() });
        if (newK != k) {
          map[newK] = map[k];
          delete map[k];
        }
      });
    }
    return map;
  }

  var revealHugoDefaults = { center: true, controls: true, history: true, progress: true, transition: "slide" };

  var revealHugoPlugins = { 
    plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealZoom ]
   };
  var revealHugoSiteParams = JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);
  var revealHugoPageParams = JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);
  
  var options = Object.assign({},
    camelize(revealHugoDefaults),
    camelize(revealHugoSiteParams),
    camelize(revealHugoPageParams),
    camelize(revealHugoPlugins));
  Reveal.initialize(options);
</script>






  

  

  

  

  

  
    
  

  
    
  

  

  
    
  

  

  

  
    
  

  

  
    
  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  



  <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({"startOnLoad":false});

    let render = (event) => {
      let mermaidElems = event.currentSlide.querySelectorAll('.mermaid');
      if (!mermaidElems.length){
          return
      }
      mermaidElems.forEach(mermaidElem => {
          let processed = mermaidElem.getAttribute('data-processed');
          if (!processed){
              
              mermaid.init(undefined, mermaidElem);
          }
      });
    };
    
    render({currentSlide: Reveal.getCurrentSlide()});

    Reveal.on('slidechanged', render);
    Reveal.on('ready', render);
  </script>

    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>

<script type="text/javascript" id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<script>
  if (/.*?(\?|&)print-pdf/.test(window.location.toString())) {
      var ytVideos = document.getElementsByTagName("iframe")
      for (let i = 0; i < ytVideos.length; i++) {
          var videoFrame = ytVideos[i]
          var isYouTube = /^https?:\/\/(www.)youtube\.com\/.*/.test(videoFrame.src)
          if (isYouTube) {
              console.log(`Removing ${videoFrame.src}`)
              var parent = videoFrame.parentElement
              videoFrame.remove()
              var p = document.createElement('p')
              p.append(
                  document.createTextNode(
                      "There was an embedded video here, but it is disabled in the printed version of the slides."
                  )
              )
              p.append(document.createElement('br'))
              p.append(
                  document.createTextNode(
                      `Visit instead ${
                          videoFrame.src
                      } or ${
                          videoFrame.src.replace(
                              /(^https?:\/\/(www.)youtube\.com)\/(embed\/)(\w+).*/,
                              "https://www.youtube.com/watch?v=$4"
                          )
                      }`
                  )
              )
              parent.appendChild(p)
          }
      }
  }
</script>

    
  

</body></html>