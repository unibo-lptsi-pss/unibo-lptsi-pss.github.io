<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
<title>Progettazione e Sviluppo del Software</title>
<meta name="description" content="Progettazione e Sviluppo del Software, Tecnologie dei Sistemi Informatici">
<meta name="author" content="Danilo Pianini">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><link rel="stylesheet" href="/reveal-js/dist/reset.css">
<link rel="stylesheet" href="/reveal-js/dist/reveal.css">
  <link rel="stylesheet" href="/css/custom-theme.min.64b25e8fc79cb2d6ebd4c0f19d110cd870679489e26e7e2cf19b4b743498a84c.css" id="theme"><link rel="stylesheet" href="/highlight-js/default.min.css">
<link href="https://fonts.googleapis.com/css?family=Roboto Mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Oxygen Mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Ubuntu Mono" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

  </head>
  <body>
    
    <div class="reveal">
      <div class="slides">
  

    <section><h1 id="inputoutput">Input/Output</h1>
<h4 id="progettazione-e-sviluppo-del-software">Progettazione e Sviluppo del Software</h4>
<h4 id="cdl-tecnologie-dei-sistemi-informatici">C.D.L. Tecnologie dei Sistemi Informatici</h4>
<h3 id="roberto-casadei-----robycasadeiuniboitmailtorobycasadeiuniboit"><a href="mailto:roby.casadei@unibo.it">Roberto Casadei — <code>roby.casadei@unibo.it</code></a></h3>
<h3 id="angelo-filaseta-----angelofilasetauniboitmailtoangelofilasetauniboit"><a href="mailto:angelo.filaseta@unibo.it">Angelo Filaseta — <code>angelo.filaseta@unibo.it</code></a></h3>
<h3 id="gianluca-aguzzi-----gianlucaaguzziuniboitmailtogianlucaaguzziuniboit"><a href="mailto:gianluca.aguzzi@unibo.it">Gianluca Aguzzi — <code>gianluca.aguzzi@unibo.it</code></a></h3>
<p><a href="?print-pdf&amp;pdfSeparateFragments=false"><i class="fa fa-print" aria-hidden="true"></i> versione stampabile</a>
</p></section><section>
<h2 id="riconoscimenti">Riconoscimenti</h2>
<ul>
<li>
<p>Questo materiale è ampiamente basato su quello realizzato dal Prof.
Mirko Viroli, che ringrazio.</p>
</li>
<li>
<p>Ogni errore riscontratovi è esclusiva responsabilità degli autori di questo documento.</p>
</li>
</ul>
</section><section>
<h2 id="outline">Outline</h2>
<h3 id="goal-della-lezione">Goal della lezione</h3>
<ul>
<li>Illustrare le API fornite da Java per l’I/O</li>
<li>Descrivere alcune scelte progettuali e pattern</li>
<li>Mostrare esempi di applicazione</li>
</ul>
<h3 id="argomenti">Argomenti</h3>
<ul>
<li>Classi per gestire file</li>
<li>Classi per gestire Stream (di input/output)</li>
<li>Classi per gestire file di testo</li>
<li>Pattern Decorator</li>
</ul>
</section><section>
<h2 id="il-problema-dellinputoutput">Il problema dell’Input/Output</h2>
<h3 id="uno-dei-problemi-fondamentali-per-un-sistema-operativo">Uno dei problemi fondamentali per un sistema operativo</h3>
<ul>
<li>Gestire le comunicazioni fra CPU e dispositivi affacciati sul BUS</li>
<li>Console, tastiera, mouse, dischi, rete, sensori, schermo</li>
<li>Vi sono varie modalità di interazione possibili
<ul>
<li>sequenziale, random-access, buffered, per carattere/linea/byte/oggetto</li>
</ul>
</li>
<li>I sistemi operativi offrono vari meccanismi
<ul>
<li>file, I/O control interface, socket per il networking, video driver</li>
</ul>
</li>
</ul>
<h3 id="la-libreria-javaio">La libreria <code>java.io.*</code></h3>
<ul>
<li>Fornisce i concetti di File e Stream di dati</li>
<li>Consente una gestione flessibile dei vari aspetti</li>
<li>È estesa con la libreria <code>java.nio</code></li>
<li>È la base di librerie avanzate (networking,..), anche di terze parti (Jackson, Gson, …)</li>
<li>I/O con l’utente in ambiente a finestre è realizzato con le GUI</li>
</ul>
</section><section>
<h1 id="file-e-loro-proprietà">File e loro proprietà</h1>
</section><section>
<h2 id="i-file">I File</h2>
<h3 id="file-system">File system</h3>
<ul>
<li>Il file system è un modulo del S.O. che gestisce la memoria secondaria</li>
<li>Maschera le diversità di dispositivi fisici (HD, CD, DVD, BR, SSD,..)</li>
<li>Maschera le diversità di contenuti informativi (testi, filmati, archivi,..)</li>
<li>Fornisce meccanismi per fornire prestazioni, concorrenza, robustezza</li>
</ul>
<h3 id="file">File</h3>
<ul>
<li>Un file system contiene un insieme di <em><strong>file</strong></em></li>
<li>Un file ha un contenuto informativo che si esprime come sequenza di byte
<ul>
<li>interpretabili in vario modo (testi, programmi, strutture dati)</li>
<li>potrebbe essere un file virtuale, che mappa un dispositivo</li>
<li>un caso particolare è la <strong>directory</strong> (ossia una tabella di ID di file)</li>
<li>può avere specifici diritti di accesso (sola lettura, lettura/scrittura, eseguibilità…)</li>
</ul>
</li>
<li>Le <strong>directory</strong> consentono un’organizzazione gerarchica (ogni file ha un percorso o <em>path</em>)</li>
</ul>
</section><section>
<h2 id="la-classe-javaiofile">La classe <code>java.io.File</code></h2>
<h3 id="usi">Usi</h3>
<ul>
<li>Serve a <em>identificare</em> un preciso file su file systems</li>
<li>Permette di ottenere <em>informazioni</em> varie sul file</li>
<li>Permette di effettuare alcune operazioni sull’intero file
<ul>
<li>cancellazione</li>
<li>spostamento (rinominazione)</li>
</ul>
</li>
<li>Permette di impostare alcune proprietà (se eseguibile, se scrivibile)</li>
<li>Permette di ottenere informazioni generali sul file system</li>
<li>Permette di creare cartelle</li>
<li>$\Rightarrow$ <em>non include operazioni per accedere al suo contenuto</em>, ma vi si potrà agganciare uno <em>stream</em></li>
</ul>
</section><section>
<h2 id="classe-javaiofile-pt1">Classe <code>java.io.File</code>: pt1</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span> <span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">File</span> <span style="color:#a90d91">implements</span> <span style="color:#000">Serializable</span>, <span style="color:#000">Comparable</span><span style="color:#000">&lt;</span><span style="color:#000">File</span><span style="color:#000">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">File</span>(<span style="color:#000">String</span> <span style="color:#000">pathname</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">File</span>(<span style="color:#000">String</span> <span style="color:#000">parent</span>, <span style="color:#000">String</span> <span style="color:#000">child</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">File</span>(<span style="color:#000">File</span> <span style="color:#000">parent</span>, <span style="color:#000">String</span> <span style="color:#000">child</span>) {...}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#177500">/* -- Path-component accessors -- */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">getName</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">getParent</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">File</span> <span style="color:#000">getParentFile</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">getPath</span>() {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#177500">/* -- Path operations -- */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">isAbsolute</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">getAbsolutePath</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">File</span> <span style="color:#000">getAbsoluteFile</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">getCanonicalPath</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">File</span> <span style="color:#000">getCanonicalFile</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#177500">/* -- Attribute accessors -- */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">canRead</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">canWrite</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">exists</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">isDirectory</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">isFile</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">isHidden</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">long</span> <span style="color:#000">lastModified</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">long</span> <span style="color:#000">length</span>() {...}
</span></span></code></pre></div></section><section>
<h2 id="classe-javaiofile-pt2">Classe <code>java.io.File</code>: pt2</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span>    <span style="color:#177500">/* -- File operations -- */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">createNewFile</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">delete</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">deleteOnExit</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">list</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">list</span>(<span style="color:#000">FilenameFilter</span> <span style="color:#000">filter</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">mkdir</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">renameTo</span>(<span style="color:#000">File</span> <span style="color:#000">dest</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setLastModified</span>(<span style="color:#a90d91">long</span> <span style="color:#000">time</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setReadOnly</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setWritable</span>(<span style="color:#a90d91">boolean</span> <span style="color:#000">writable</span>, <span style="color:#a90d91">boolean</span> <span style="color:#000">ownerOnly</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setWritable</span>(<span style="color:#a90d91">boolean</span> <span style="color:#000">writable</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setReadable</span>(<span style="color:#a90d91">boolean</span> <span style="color:#000">readable</span>, <span style="color:#a90d91">boolean</span> <span style="color:#000">ownerOnly</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setReadable</span>(<span style="color:#a90d91">boolean</span> <span style="color:#000">readable</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setExecutable</span>(<span style="color:#a90d91">boolean</span> <span style="color:#000">executable</span>, <span style="color:#a90d91">boolean</span> <span style="color:#000">ownerOnly</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">setExecutable</span>(<span style="color:#a90d91">boolean</span> <span style="color:#000">executable</span>) {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">canExecute</span>() {...}
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#177500">/* -- Disk usage -- */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">long</span> <span style="color:#000">getTotalSpace</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">long</span> <span style="color:#000">getFreeSpace</span>() {...}
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">long</span> <span style="color:#000">getUsableSpace</span>() {...}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="esempio-di-utilizzo-di-file-cercare-file-con-una-certa-enstensione-dentro-una-directory">Esempio di utilizzo di File: cercare file con una certa enstensione dentro una directory</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.io.files</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.File</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.ArrayList</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.List</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">FileUtil</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">final</span> <span style="color:#000">String</span> <span style="color:#000">USER_HOME</span> <span style="color:#000">=</span> <span style="color:#000">System</span>.<span style="color:#836c28">getProperty</span>(<span style="color:#c41a16">"user.home"</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">List</span><span style="color:#000">&lt;</span><span style="color:#000">File</span><span style="color:#000">&gt;</span> <span style="color:#000">findFilesInHomeDirectoryByExtension</span>(<span style="color:#a90d91">final</span> <span style="color:#000">String</span> <span style="color:#000">ext</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">userHome</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">File</span>(<span style="color:#000">USER_HOME</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">allFiles</span> <span style="color:#000">=</span> <span style="color:#000">userHome</span>.<span style="color:#836c28">listFiles</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">if</span> (<span style="color:#000">!</span><span style="color:#000">userHome</span>.<span style="color:#836c28">isDirectory</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">throw</span> <span style="color:#a90d91">new</span> <span style="color:#000">IllegalStateException</span>(<span style="color:#c41a16">"The user home is not a directory!"</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">result</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">ArrayList</span><span style="color:#000">&lt;</span><span style="color:#000">File</span><span style="color:#000">&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">for</span> (<span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">file</span>: <span style="color:#000">allFiles</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">if</span> (<span style="color:#000">file</span>.<span style="color:#836c28">isFile</span>() <span style="color:#000">&amp;&amp;</span> <span style="color:#000">file</span>.<span style="color:#836c28">getName</span>().<span style="color:#836c28">endsWith</span>(<span style="color:#c41a16">"."</span> <span style="color:#000">+</span> <span style="color:#000">ext</span>)) {
</span></span><span style="display:flex;"><span>                <span style="color:#000">result</span>.<span style="color:#836c28">add</span>(<span style="color:#000">file</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#000">result</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="accedere-al-contenuto-di-un-file">Accedere al contenuto di un file</h2>
<h3 id="come-fare">Come fare?</h3>
<ul>
<li>Un file ha un contenuto informativo (potenzialmente di grosse dimensioni)</li>
<li>Lo si potrebbe leggere (in vari modi)</li>
<li>Lo si potrebbe scrivere (in vari modi)</li>
<li>Il suo contenuto potrebbe essere interpretabile in vari modi</li>
</ul>
<h3 id="alcuni-di-tali-concetti-sono-condivisi-con-altri-meccanismi">Alcuni di tali concetti sono condivisi con altri meccanismi</h3>
<ul>
<li>Risorse interne al classpath Java</li>
<li>Networking e file di rete</li>
<li>Archivi su database</li>
<li>Depositi di informazione in memoria</li>
</ul>
<h4 id="il-concetto-di-__inputoutput-stream__-è-usato-come-astrazione-unificante">Il concetto di <em><strong>input/output-stream</strong></em> è usato come astrazione unificante</h4>
</section><section>
<h1 id="inputoutputstream">Input/OutputStream</h1>
</section><section>
<h2 id="overview-sugli-inputstream-e-outputstream-in-java">Overview sugli <code>InputStream</code> e <code>OutputStream</code> in Java</h2>
<h3 id="inputstream-e-outputstream"><code>InputStream</code> e <code>OutputStream</code></h3>
<ul>
<li>Stream = flusso (di dati)</li>
<li>Di base, gestiscono flussi binari (di <code>byte</code>) leggibili vs. scrivibili</li>
<li>Sono classi astratte (e non interfacce..)</li>
<li>Possono essere specializzate da “sottoclassi” e “decorazioni”, tra cui
<ul>
<li>Per diverse sorgenti e destinazioni di informazione
<ul>
<li>su file (<code>File</code>(<code>In</code>|<code>Out</code>)<code>putStream</code>)</li>
<li>su memoria (<code>ByteArray</code>(<code>In</code>|<code>Out</code>)<code>putStream</code>)</li>
</ul>
</li>
<li>Per tipo di informazione:
<ul>
<li>valori primitivi (<code>Data</code>(<code>In</code>|<code>Out</code>)<code>putStream</code>)</li>
<li>interi oggetti Java (<code>Object</code>(<code>In</code>|<code>Out</code>)<code>putStream</code>)</li>
<li>archivi compressi (<code>Zip</code>(<code>In</code>|<code>Out</code>)<code>putStream</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="tipicamente-usati-per-alimentare-altre-classi">Tipicamente usati per alimentare altre classi</h3>
<ul>
<li>File di testo (<code>Reader</code>, <code>Writer</code>, e specializzazioni)</li>
<li>Librerie avanzate comunemente usate per l’accesso al file system tipicamente hanno metodi che accettano (<code>In</code>|<code>Out</code>)<code>putStream</code></li>
</ul>
</section><section>
<h2 id="la-classe-javaioinputstream">La classe <code>java.io.InputStream</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">abstract</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">InputStream</span> <span style="color:#a90d91">implements</span> <span style="color:#000">Closeable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// Reads the next byte (0 to 255, -1 is end-of-stream)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">abstract</span> <span style="color:#a90d91">int</span> <span style="color:#000">read</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">read</span>(<span style="color:#a90d91">byte</span> <span style="color:#000">b</span><span style="color:#000">[]</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">read</span>(<span style="color:#a90d91">byte</span> <span style="color:#000">b</span><span style="color:#000">[]</span>, <span style="color:#a90d91">int</span> <span style="color:#000">off</span>, <span style="color:#a90d91">int</span> <span style="color:#000">len</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">long</span> <span style="color:#000">skip</span>(<span style="color:#a90d91">long</span> <span style="color:#000">n</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">available</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">close</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">synchronized</span> <span style="color:#a90d91">void</span> <span style="color:#000">mark</span>(<span style="color:#a90d91">int</span> <span style="color:#000">readlimit</span>) {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">synchronized</span> <span style="color:#a90d91">void</span> <span style="color:#000">reset</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">markSupported</span>() {...}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="fileinputstream-e-bytearrayinputstream"><code>FileInputStream</code> e <code>ByteArrayInputStream</code></h2>
<div class="mermaid" data-processed="true" pre-rendered="true"><svg aria-labelledby="chart-title-mermaid-1699289579234 chart-desc-mermaid-1699289579234" role="img" viewBox="0 0 563.5 356" style="max-width: 563.5px;" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-1699289579234"><title id="chart-title-mermaid-1699289579234"></title><desc id="chart-desc-mermaid-1699289579234"></desc><style>#mermaid-1699289579234 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1699289579234 .error-icon{fill:#552222;}#mermaid-1699289579234 .error-text{fill:#552222;stroke:#552222;}#mermaid-1699289579234 .edge-thickness-normal{stroke-width:2px;}#mermaid-1699289579234 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1699289579234 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1699289579234 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1699289579234 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1699289579234 .marker{fill:#333333;stroke:#333333;}#mermaid-1699289579234 .marker.cross{stroke:#333333;}#mermaid-1699289579234 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1699289579234 g.classGroup text{fill:#9370DB;fill:#131300;stroke:none;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:10px;}#mermaid-1699289579234 g.classGroup text .title{font-weight:bolder;}#mermaid-1699289579234 .nodeLabel,#mermaid-1699289579234 .edgeLabel{color:#131300;}#mermaid-1699289579234 .edgeLabel .label rect{fill:#ECECFF;}#mermaid-1699289579234 .label text{fill:#131300;}#mermaid-1699289579234 .edgeLabel .label span{background:#ECECFF;}#mermaid-1699289579234 .classTitle{font-weight:bolder;}#mermaid-1699289579234 .node rect,#mermaid-1699289579234 .node circle,#mermaid-1699289579234 .node ellipse,#mermaid-1699289579234 .node polygon,#mermaid-1699289579234 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1699289579234 .divider{stroke:#9370DB;stroke:1;}#mermaid-1699289579234 g.clickable{cursor:pointer;}#mermaid-1699289579234 g.classGroup rect{fill:#ECECFF;stroke:#9370DB;}#mermaid-1699289579234 g.classGroup line{stroke:#9370DB;stroke-width:1;}#mermaid-1699289579234 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5;}#mermaid-1699289579234 .classLabel .label{fill:#9370DB;font-size:10px;}#mermaid-1699289579234 .relation{stroke:#333333;stroke-width:1;fill:none;}#mermaid-1699289579234 .dashed-line{stroke-dasharray:3;}#mermaid-1699289579234 #compositionStart,#mermaid-1699289579234 .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #compositionEnd,#mermaid-1699289579234 .composition{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #dependencyStart,#mermaid-1699289579234 .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #dependencyStart,#mermaid-1699289579234 .dependency{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #extensionStart,#mermaid-1699289579234 .extension{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #extensionEnd,#mermaid-1699289579234 .extension{fill:#333333!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #aggregationStart,#mermaid-1699289579234 .aggregation{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #aggregationEnd,#mermaid-1699289579234 .aggregation{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #lollipopStart,#mermaid-1699289579234 .lollipop{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 #lollipopEnd,#mermaid-1699289579234 .lollipop{fill:#ECECFF!important;stroke:#333333!important;stroke-width:1;}#mermaid-1699289579234 .edgeTerminals{font-size:11px;}#mermaid-1699289579234 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><defs><marker orient="auto" markerHeight="240" markerWidth="190" refY="7" refX="0" class="marker aggregation classDiagram" id="classDiagram-aggregationStart"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="19" class="marker aggregation classDiagram" id="classDiagram-aggregationEnd"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="240" markerWidth="190" refY="7" refX="0" class="marker extension classDiagram" id="classDiagram-extensionStart"><path d="M 1,7 L18,13 V 1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="19" class="marker extension classDiagram" id="classDiagram-extensionEnd"><path d="M 1,1 V 13 L18,7 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="240" markerWidth="190" refY="7" refX="0" class="marker composition classDiagram" id="classDiagram-compositionStart"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="19" class="marker composition classDiagram" id="classDiagram-compositionEnd"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="240" markerWidth="190" refY="7" refX="0" class="marker dependency classDiagram" id="classDiagram-dependencyStart"><path d="M 5,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="28" markerWidth="20" refY="7" refX="19" class="marker dependency classDiagram" id="classDiagram-dependencyEnd"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><defs><marker orient="auto" markerHeight="240" markerWidth="190" refY="7" refX="0" class="marker lollipop classDiagram" id="classDiagram-lollipopStart"><circle r="6" cy="7" cx="6" fill="white" stroke="black"></circle></marker></defs><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-start="url(#classDiagram-extensionStart)" style="fill:none" class="edge-pattern-solid relation" id="id1" d="M142.359375,197L137.15104166666666,201.16666666666666C131.94270833333334,205.33333333333334,121.52604166666667,213.66666666666666,116.31770833333333,222C111.109375,230.33333333333334,111.109375,238.66666666666666,111.109375,242.83333333333334L111.109375,247"></path><path marker-start="url(#classDiagram-extensionStart)" style="fill:none" class="edge-pattern-solid relation" id="id2" d="M378.609375,197L383.8177083333333,201.16666666666666C389.0260416666667,205.33333333333334,399.4427083333333,213.66666666666666,404.6510416666667,222C409.859375,230.33333333333334,409.859375,238.66666666666666,409.859375,242.83333333333334L409.859375,247"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(260.484375, 102.5)" id="classid-InputStream-0" class="node default"><rect height="189" width="239.71875" y="-94.5" x="-119.859375" class="outer title-state"></rect><line y2="-64.5" y1="-64.5" x2="119.859375" x1="-119.859375" class="divider"></line><line y2="-48.5" y1="-48.5" x2="119.859375" x1="-119.859375" class="divider"></line><g class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"></span></div></foreignObject><foreignObject transform="translate( -46.671875, -87)" height="18" width="93.34375" class="classTitle"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">InputStream</span></div></foreignObject><foreignObject transform="translate( -112.359375, -41)" height="18" width="72.921875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">read() : int</span></div></foreignObject><foreignObject transform="translate( -112.359375, -19)" height="18" width="125.390625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">read(byte b[]) : int</span></div></foreignObject><foreignObject transform="translate( -112.359375, 3)" height="18" width="224.71875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">read(byte b[], int off, int len) : int</span></div></foreignObject><foreignObject transform="translate( -112.359375, 25)" height="18" width="126.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">skip(long n) : long</span></div></foreignObject><foreignObject transform="translate( -112.359375, 47)" height="18" width="104.046875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">available() : int</span></div></foreignObject><foreignObject transform="translate( -112.359375, 69)" height="18" width="90.703125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">close() : void</span></div></foreignObject></g></g><g transform="translate(111.109375, 297.5)" id="classid-FileInputStream-1" class="node default"><rect height="101" width="206.21875" y="-50.5" x="-103.109375" class="outer title-state"></rect><line y2="-20.5" y1="-20.5" x2="103.109375" x1="-103.109375" class="divider"></line><line y2="-4.5" y1="-4.5" x2="103.109375" x1="-103.109375" class="divider"></line><g class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"></span></div></foreignObject><foreignObject transform="translate( -60.453125, -43)" height="18" width="120.90625" class="classTitle"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">FileInputStream</span></div></foreignObject><foreignObject transform="translate( -95.609375, 3)" height="18" width="191.21875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">getChannel() : FileChannel</span></div></foreignObject><foreignObject transform="translate( -95.609375, 25)" height="18" width="166.25"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">getFD() : FileDescriptor</span></div></foreignObject></g></g><g transform="translate(409.859375, 297.5)" id="classid-ByteArrayInputStream-2" class="node default"><rect height="101" width="291.28125" y="-50.5" x="-145.640625" class="outer title-state"></rect><line y2="-20.5" y1="-20.5" x2="145.640625" x1="-145.640625" class="divider"></line><line y2="-4.5" y1="-4.5" x2="145.640625" x1="-145.640625" class="divider"></line><g class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel"></span></div></foreignObject><foreignObject transform="translate( -84.9140625, -43)" height="18" width="169.828125" class="classTitle"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">ByteArrayInputStream</span></div></foreignObject><foreignObject transform="translate( -138.140625, 3)" height="18" width="152.953125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">readAllBytes() : byte[]</span></div></foreignObject><foreignObject transform="translate( -138.140625, 25)" height="18" width="276.28125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">readNBytes(byte[] b, int off, int len) : int</span></div></foreignObject></g></g></g></g></g></svg></div>

</section><section>
<h2 id="uso-di-bytearrayinputstream">Uso di <code>ByteArrayInputStream</code></h2>
<h3 id="bytearrayinputstream"><code>ByteArrayInputStream</code></h3>
<ul>
<li>crea un <code>InputStream</code> a partire da un <code>byte[]</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.io.files</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.ByteArrayInputStream</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.IOException</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.InputStream</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseByteArrayStream</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> <span style="color:#000">b</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> { <span style="color:#000">10</span>, <span style="color:#000">20</span>, <span style="color:#000">-</span><span style="color:#000">1</span>, <span style="color:#000">40</span>, <span style="color:#000">-</span><span style="color:#000">58</span> };
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">InputStream</span> <span style="color:#000">in</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">ByteArrayInputStream</span>(<span style="color:#000">b</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">int</span> <span style="color:#000">c</span> <span style="color:#000">=</span> <span style="color:#000">in</span>.<span style="color:#836c28">read</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">while</span> (<span style="color:#000">c</span> <span style="color:#000">!=</span> <span style="color:#000">-</span><span style="color:#000">1</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">c</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#000">c</span> <span style="color:#000">=</span> <span style="color:#000">in</span>.<span style="color:#836c28">read</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"End of stream"</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#a90d91">finally</span> { <span style="color:#177500">// assicura la chiusura anche con eccezioni</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">in</span>.<span style="color:#836c28">close</span>(); <span style="color:#177500">// problema: può tirare eccezione!</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="il-costrutto-try-with-resources">Il costrutto <code>try-with-resources</code></h2>
<ul>
<li>vuole la creazione di un <code>java.lang.AutoCloseable</code> come primo argomento</li>
<li>ne assicura la chiusura</li>
<li>si possono opzionalmente aggiungere delle <code>catch</code> di eccezioni</li>
<li>è il modo preferibile di utilizzare risorse in Java!</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.io.files</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.ByteArrayInputStream</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.IOException</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.InputStream</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseTryWithResources</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> <span style="color:#000">b</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> { <span style="color:#000">10</span>, <span style="color:#000">20</span>, <span style="color:#000">30</span>, <span style="color:#000">40</span>, <span style="color:#000">50</span> };
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span> (<span style="color:#a90d91">final</span> <span style="color:#000">InputStream</span> <span style="color:#000">in</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">ByteArrayInputStream</span>(<span style="color:#000">b</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">int</span> <span style="color:#000">c</span> <span style="color:#000">=</span> <span style="color:#000">in</span>.<span style="color:#836c28">read</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">while</span> (<span style="color:#000">c</span> <span style="color:#000">!=</span> <span style="color:#000">-</span><span style="color:#000">1</span>) { <span style="color:#177500">// C-style</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">c</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#000">c</span> <span style="color:#000">=</span> <span style="color:#000">in</span>.<span style="color:#836c28">read</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"End of stream"</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="esempio-streamdumper">Esempio <code>StreamDumper</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.io.files</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.IOException</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.InputStream</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">StreamDumper</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// rendo inaccessibile il costruttore</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#000">StreamDumper</span>() {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">dump</span>(<span style="color:#a90d91">final</span> <span style="color:#000">InputStream</span> <span style="color:#000">input</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">value</span> <span style="color:#000">=</span> <span style="color:#000">input</span>.<span style="color:#836c28">read</span>(); <span style="color:#000">value</span> <span style="color:#000">!=</span> <span style="color:#000">-</span><span style="color:#000">1</span>; <span style="color:#000">value</span> <span style="color:#000">=</span> <span style="color:#000">input</span>.<span style="color:#836c28">read</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">print</span>(<span style="color:#000">value</span> <span style="color:#000">+</span> <span style="color:#c41a16">"\t"</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="usestreamdumper----uso-uniforme-di-vari-inputstream"><code>UseStreamDumper</code> – uso uniforme di vari <code>InputStream</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.io.files</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseStreamDumper</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> <span style="color:#000">bytes</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span>{ <span style="color:#000">10</span>, <span style="color:#000">20</span>, <span style="color:#000">30</span> };
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// Cerco un file txt nella home folder dell'utente</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">txtFiles</span> <span style="color:#000">=</span> <span style="color:#000">FileUtil</span>.<span style="color:#836c28">findFilesInHomeDirectoryByExtension</span>(<span style="color:#c41a16">"txt"</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">if</span> (<span style="color:#000">txtFiles</span>.<span style="color:#836c28">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">throw</span> <span style="color:#a90d91">new</span> <span style="color:#000">IllegalStateException</span>(<span style="color:#c41a16">"No txt files on the user home directory!"</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">file</span> <span style="color:#000">=</span> <span style="color:#000">txtFiles</span>.<span style="color:#836c28">get</span>(<span style="color:#000">0</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">final</span> <span style="color:#000">InputStream</span> <span style="color:#000">input</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">ByteArrayInputStream</span>(<span style="color:#000">bytes</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">final</span> <span style="color:#000">InputStream</span> <span style="color:#000">input2</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">FileInputStream</span>(<span style="color:#000">file</span>);
</span></span><span style="display:flex;"><span>        ) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">txtFiles</span>.<span style="color:#836c28">get</span>(<span style="color:#000">0</span>).<span style="color:#836c28">getAbsolutePath</span>());
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"First stream (from memory):"</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#000">StreamDumper</span>.<span style="color:#836c28">dump</span>(<span style="color:#000">input</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"\nSecond stream (from file "</span> <span style="color:#000">+</span> <span style="color:#000">file</span>.<span style="color:#836c28">getPath</span>() <span style="color:#000">+</span> <span style="color:#c41a16">":"</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#000">StreamDumper</span>.<span style="color:#836c28">dump</span>(<span style="color:#000">input2</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="la-classe-javaiooutputstream">La classe <code>java.io.OutputStream</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">abstract</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">OutputStream</span> <span style="color:#a90d91">implements</span> <span style="color:#000">Closeable</span>, <span style="color:#000">Flushable</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#177500">/**
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * ...
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * The byte to be written is the eight low-order bits of the argument &lt;code&gt;b&lt;/code&gt;.
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * The 24 high-order bits of &lt;code&gt;b&lt;/code&gt; are ignored.
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     *
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * 0x000000FF writes byte 0xFF (255)
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * 0xFFFFFFFF writes byte 0xFF (255)
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * 0x12345678 writes byte 0x78 (120)
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">abstract</span> <span style="color:#a90d91">void</span> <span style="color:#000">write</span>(<span style="color:#a90d91">int</span> <span style="color:#000">b</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">write</span>(<span style="color:#a90d91">byte</span> <span style="color:#000">b</span><span style="color:#000">[]</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">write</span>(<span style="color:#a90d91">byte</span> <span style="color:#000">b</span><span style="color:#000">[]</span>, <span style="color:#a90d91">int</span> <span style="color:#000">off</span>, <span style="color:#a90d91">int</span> <span style="color:#000">len</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">flush</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">close</span>() <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {...}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="stream-di-uscita----duale-allinputstream">Stream di uscita – Duale all’<code>InputStream</code></h3>
<ul>
<li>Esistono anche le analoghe specializzazioni <code>ByteArrayOutputStream</code> e <code>FileOutputStream</code></li>
</ul>
</section><section>
<h2 id="useoutputstream"><code>UseOutputStream</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.FileOutputStream</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.IOException</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.OutputStream</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.Random</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseOutputStream</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#a90d91">final</span> <span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span> (
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">final</span> <span style="color:#000">OutputStream</span> <span style="color:#000">output</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">FileOutputStream</span>(<span style="color:#000">UseFile</span>.<span style="color:#836c28">FILE_NAME</span>);
</span></span><span style="display:flex;"><span>        ) {
</span></span><span style="display:flex;"><span>            <span style="color:#177500">// Aggiungo byte random</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">final</span> <span style="color:#000">Random</span> <span style="color:#000">r</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Random</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">100</span>; <span style="color:#000">i</span><span style="color:#000">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#000">output</span>.<span style="color:#836c28">write</span>(<span style="color:#000">r</span>.<span style="color:#836c28">nextInt</span>(<span style="color:#000">256</span>));
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#177500">// Aggiungo un array di byte</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">final</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> <span style="color:#000">b</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> { <span style="color:#000">10</span>, <span style="color:#000">20</span>, <span style="color:#000">30</span>, <span style="color:#000">40</span> };
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">10</span>; <span style="color:#000">i</span><span style="color:#000">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#000">output</span>.<span style="color:#836c28">write</span>(<span style="color:#000">b</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="solo-byte">Solo <code>byte</code>?</h2>
<ul>
<li>Vorremmo poter leggere e scrivere formati dati diversi
<ul>
<li>Ad esempio testi</li>
<li>Oppure avere dei flussi di dati che vengono compressi</li>
</ul>
</li>
</ul>
<h3 id="il-concetto-di-decoratore">Il concetto di decoratore</h3>
<p>Per ottenere questo risultato, si “circonda” l’(<code>In</code>|<code>Out</code>)<code>putStream</code> con un altro,
che si occupa di aggiungere funzionalità:</p>
<ul>
<li><em>tradurre</em> un certo tipo di dati (ad esempio testo) da/a sequenza di byte</li>
<li><em>modificare il formato</em> della sequenza di byte (ad esempio, (de)comprimendo il flusso in formato zip)</li>
<li>lasciando inalterato il flusso, modificarne la gestione
(ad esempio, registrando statistiche o aggiungendo un buffer per migliorare le performance)</li>
</ul>
<p>Ad sempio, si definisce <code>Buffered</code>(<code>In</code>|<code>Out</code>)<code>putStream</code> che estende (<code>In</code>|<code>Out</code>)<code>putStream</code> aggiungendo un buffer intermedio</p>
<ul>
<li><code>Buffered</code>(<code>In</code>|<code>Out</code>)<code>putStream</code> fa da <em>wrapper</em> per un altro (<code>In</code>|<code>Out</code>)<code>putStream</code> al quale delega le operazioni</li>
<li><code>Buffered</code>(<code>In</code>|<code>Out</code>)<code>putStream</code> è quindi un <strong>decoratore</strong> per (<code>In</code>|<code>Out</code>)<code>putStream</code>
<ul>
<li>ne modifica il funzionamento senza modificarlo!</li>
</ul>
</li>
</ul>
<p>Con questa tecnica è possibile <em>decorare</em> qualunque (<code>In</code>|<code>Out</code>)<code>putStream</code>!</p>
</section><section>
<h2 id="decorazione-in-generale">Decorazione, in generale</h2>
<!-- ```mermaid
classDiagram
class Component {
  +operation()
}
class ConcreteComponent {
  +operation()
}
class Decorator {
  -component: Component
  +operation()
}
class ConcreteDecorator {
  +operation()
}
Component <|-- ConcreteComponent
Component <|-- Decorator
Component --o Decorator
Decorator <|-- ConcreteDecorator
``` -->
<p><a href="https://mermaid.live/edit#pako:eNqNkTEOwyAMRa-CPLVquADq1tygK4sFThsp4IjAUKW5e1GihrRZsmH78f-XPYJhS6DAdDgMdYuPgE77uRI3dj178lGM2gtx4Z4Cxpb96az9VChvAkU6RtdkOLc5LJQ031-q2B0w-5PZ0SXM9S3lPuOOWAW3Eyl5OyimP6JrGypwFBy2Ni90zqUhPsmRBpWflhpMXdSQE2YUU-T7yxtQMSSqIPUWs9hyAlANdgNNH94AlqM"><img src="https://mermaid.ink/svg/pako:eNqNkTEOwyAMRa-CPLVquADq1tygK4sFThsp4IjAUKW5e1GihrRZsmH78f-XPYJhS6DAdDgMdYuPgE77uRI3dj178lGM2gtx4Z4Cxpb96az9VChvAkU6RtdkOLc5LJQ031-q2B0w-5PZ0SXM9S3lPuOOWAW3Eyl5OyimP6JrGypwFBy2Ni90zqUhPsmRBpWflhpMXdSQE2YUU-T7yxtQMSSqIPUWs9hyAlANdgNNH94AlqM?type=png" alt=""></a></p>
</section><section>
<h2 id="decorazione-il-caso-di-bufferedinputstream">Decorazione, il caso di <code>BufferedInputStream</code></h2>
<!-- ```mermaid
classDiagram-v2

class ByteArrayOutputStream {
  +ByteArrayOutputStream() ByteArrayOutputStream
  +ByteArrayOutputStream(int) ByteArrayOutputStream
  size() int
  toByteArray() byte[]
  writeBytes(byte[]) void
  writeTo(OutputStream) void
}


class FileOutputStream {
  +FileOutputStream(String) FileOutputStream
  +FileOutputStream(File) FileOutputStream
  +FileOutputStream(FileDescriptor) FileOutputStream
  +getFD() FileDescriptor
  +getChannel() FileChannel
}

class OutputStream {
  +OutputStream() OutputStream
  +close() void
  +flush() void
  +write(byte[]) void
  +write(byte[], int, int) void
  +write(int) void
}
<<Abstract>> OutputStream

class FilterOutputStream {
  #out: OutputStream
  +flush(): void
  +read() int
  +read(byte[]) int
  +read(byte[], int, int) int
  +skip(long) long
}
<<Abstract>> FilterOutputStream

class DeflaterOutputStream {
  +DeflaterOutputStream(OutputStream) DeflaterOutputStream
  +DeflaterOutputStream(OutputStream,Deflater) DeflaterOutputStream
  #deflate() void
}
<<Abstract>> DeflaterOutputStream

class BufferedOutputStream {
  +BufferedOutputStream(OutputStream) BufferedOutputStream
  +BufferedOutputStream(OutputStream, int) BufferedOutputStream
}

class PrintStream {
  +PrintStream(File, Charset) PrintStream
  +PrintStream(OutputStream, boolean, Charset) PrintStream
  +PrintStream(String, Charset) PrintStream
  +format(Locale, String, Object[]) PrintStream
  +print(Object)
  +printf(Locale, String, Object[]) PrintStream
  +println(Object)
}

class ZipOutputStream {
  +ZipOutputStream(OutputStreamout) ZipOutputStream
  +ZipOutputStream(OutputStream, Charset) ZipOutputStream
  setComment(String) void
  setMethod(int) void
  setLevel(int) void
  putNextEntry(ZipEntry) void
  closeEntry() void
}

OutputStream <|-- FileOutputStream
OutputStream <|-- ByteArrayOutputStream
OutputStream <|-- FilterOutputStream
OutputStream --o FilterOutputStream
FilterOutputStream <|-- BufferedOutputStream
FilterOutputStream <|-- PrintStream
FilterOutputStream <|-- DeflaterOutputStream
DeflaterOutputStream <|-- ZipOutputStream
``` -->
<p><a href="https://mermaid.live/edit#pako:eNqVVktz0zAQ_ise9eJMkgtHT6YzpaGnQpkpJzAHxV4nAlnyyHIglP53Vn7ED61Dekms_b5d7dt-YYlOgUUskbwst4LvDc_Xx3exilUtCt6fLNwZw09PlS0q-2wN8Dx4iVUQLEksXNA6FzSEsheUSvEH0CiS3MnqMxGFO3z-9t3JfxlhwUFl2AgXwVGL9Ax90eHQcIe-uki7WB-EBCLMqTjEP6H2C49Ps53gLdwtlIkRhdVmRmsP9mEbNmBP7qD7A1cKZIu3pzbQJkwixEkBvSsTqUtXhC6ly0xW5WEoqJPspX4kXrka1j8eYSBDRzebu11pDU_s7e3El0GpLBg_khtd2cj3v3U36u9FKO27qjl23hPCoe8dXP4URSi16wT367vuO9kHsIVMcjKEJQVNmpeiXKe76hjzRm7SBgjnSkIrnjdGlWVgIKUWBgFNIqMo1-m21aENDNr_Mw7v2K2BpJ7AVYBjY0pAawPIo44v32ktgasrdZsVcoGcaZNzGz7qhDuHOv7T7gck1jXpVKFw57DBF70ke6sJqXojg6x9FQVR0Il0lBKcxMVU7b9Kg4wQqii_13kOGGi3g7uBRugj2INOw9F-QfEjHHEdjqRo9BP8th-UNacQ76kferjedg04ek-MErD5u14T-9nnzLzYSGPeUI1Y67UmScQybG4mR2GOPeqGORI9-uQyq_mTIrIVywEbW6T4zVG3UMzsAXKIWYSPuHh4JW3MMOFI5ZXVzyeVsMiaClasKlK8pf1KYVHGZQmv_wCwXzaG"><img src="https://mermaid.ink/svg/pako:eNqVVktz0zAQ_ise9eJMkgtHT6YzpaGnQpkpJzAHxV4nAlnyyHIglP53Vn7ED61Dekms_b5d7dt-YYlOgUUskbwst4LvDc_Xx3exilUtCt6fLNwZw09PlS0q-2wN8Dx4iVUQLEksXNA6FzSEsheUSvEH0CiS3MnqMxGFO3z-9t3JfxlhwUFl2AgXwVGL9Ax90eHQcIe-uki7WB-EBCLMqTjEP6H2C49Ps53gLdwtlIkRhdVmRmsP9mEbNmBP7qD7A1cKZIu3pzbQJkwixEkBvSsTqUtXhC6ly0xW5WEoqJPspX4kXrka1j8eYSBDRzebu11pDU_s7e3El0GpLBg_khtd2cj3v3U36u9FKO27qjl23hPCoe8dXP4URSi16wT367vuO9kHsIVMcjKEJQVNmpeiXKe76hjzRm7SBgjnSkIrnjdGlWVgIKUWBgFNIqMo1-m21aENDNr_Mw7v2K2BpJ7AVYBjY0pAawPIo44v32ktgasrdZsVcoGcaZNzGz7qhDuHOv7T7gck1jXpVKFw57DBF70ke6sJqXojg6x9FQVR0Il0lBKcxMVU7b9Kg4wQqii_13kOGGi3g7uBRugj2INOw9F-QfEjHHEdjqRo9BP8th-UNacQ76kferjedg04ek-MErD5u14T-9nnzLzYSGPeUI1Y67UmScQybG4mR2GOPeqGORI9-uQyq_mTIrIVywEbW6T4zVG3UMzsAXKIWYSPuHh4JW3MMOFI5ZXVzyeVsMiaClasKlK8pf1KYVHGZQmv_wCwXzaG" alt=""></a></p>
</section><section>
<h2 id="decoratori">Decoratori</h2>
<h3 id="pro-e-contro">Pro e contro</h3>
<ul>
<li>Sono un mix di polimorfismo e incapsulamento</li>
<li>Consentono di comporre funzionalità in modo piuttosto flessibile</li>
<li>Danno luogo a più flessibilità rispetto all’ereditarietà</li>
<li>Più complicati da usare e comprendere</li>
</ul>
<h3 id="con-gli-inoutputstream-è-possibile-comporre">Con gli (<code>In</code>|<code>Out</code>)<code>putStream</code>, è possibile comporre:</h3>
<ul>
<li>Uno stream di sorgente/destinazione dati</li>
<li><code>File</code>(<code>In</code>|<code>Out</code>)<code>putStream</code>, <code>ByteArray</code>(<code>In</code>|<code>Out</code>)<code>putStream</code></li>
<li>Uno (o più) stream di gestione interna: <code>Buffer</code>(<code>In</code>|<code>Out</code>)<code>putStream</code>, ..</li>
<li>Uno stream di presentazione dati:</li>
<li><code>PrintStream</code>, formato stringhe testuali</li>
<li><code>DataInputStream</code>, dati grezzi (non visto)</li>
<li><code>ObjectInputStream</code>, interi oggetti (non visto)</li>
</ul>
</section><section>
<h2 id="decoratori-in-azione">Decoratori in azione</h2>
<p>Scrittura di testo su file</p>
<p><a href="https://mermaid.live/edit#pako:eNplUDFuwzAM_AqhyQWSIRk9ZGnRqUCKZuiihbaYRIVFGRIVxAjy99KQkbYoF1LHI3mnm-mjI9OaU8LxDG8flkEjl64C78mzHCQRhtqZI8VN8xz5Qkky7Lsv6jVLBOV5PmVAdiBn4hnrJiHAlHDKT382wHq907z9AR9HX_1A-yJj-Xe5zm6bz-SFMkSGo3J_LSZ29fEork2Pw5BhnJ3AiDmrRpW4CF9mr4ucjWWzMoFSQO_0W25z2xp1E8iaVktHRyyDWGP5rlQsEg8T96aVVGhlyuhQ6MWjWgkVvH8DgNBxIg"><img src="https://mermaid.ink/svg/pako:eNplUDFuwzAM_AqhyQWSIRk9ZGnRqUCKZuiihbaYRIVFGRIVxAjy99KQkbYoF1LHI3mnm-mjI9OaU8LxDG8flkEjl64C78mzHCQRhtqZI8VN8xz5Qkky7Lsv6jVLBOV5PmVAdiBn4hnrJiHAlHDKT382wHq907z9AR9HX_1A-yJj-Xe5zm6bz-SFMkSGo3J_LSZ29fEork2Pw5BhnJ3AiDmrRpW4CF9mr4ucjWWzMoFSQO_0W25z2xp1E8iaVktHRyyDWGP5rlQsEg8T96aVVGhlyuhQ6MWjWgkVvH8DgNBxIg?type=svg" alt=""></a></p>
<p>Scrittura di testo su file in modo bufferizzato</p>
<p><a href="https://mermaid.live/edit#pako:eNp1UcFuwjAM_RUrpyKVA4hTDzts006TmMZhl17cxoWg1omchFEh_n3pWhUxNF_sPD_72c5F1VaTKtRe0B3g_bNkSOZjNQIfYjjsghB2Y2YwsavsxfKJJHjYVkeqkw8WEs_w3gOyhnAgHrCqDwQogr1f3HWA5fIp-fUNnEWfY9OQkN7G4OKD-li_zkaWH5TgW0wgn4PpnNhTGgIcSWOlQ65p8VA7aW_uE7P-m2npf-2xxyb7-tUEy9Ak_h8RYn0D5sccnLMa29aDG84LDr0fZkaerjk1O09zrkpWueoorWN0-qvLkC5VWryjUhUp1NRgbEOpSr4mKsZgdz3XqggSKVfRaQz0ajDt16miwdbT9QdD2JwT"><img src="https://mermaid.ink/svg/pako:eNp1UcFuwjAM_RUrpyKVA4hTDzts006TmMZhl17cxoWg1omchFEh_n3pWhUxNF_sPD_72c5F1VaTKtRe0B3g_bNkSOZjNQIfYjjsghB2Y2YwsavsxfKJJHjYVkeqkw8WEs_w3gOyhnAgHrCqDwQogr1f3HWA5fIp-fUNnEWfY9OQkN7G4OKD-li_zkaWH5TgW0wgn4PpnNhTGgIcSWOlQ65p8VA7aW_uE7P-m2npf-2xxyb7-tUEy9Ak_h8RYn0D5sccnLMa29aDG84LDr0fZkaerjk1O09zrkpWueoorWN0-qvLkC5VWryjUhUp1NRgbEOpSr4mKsZgdz3XqggSKVfRaQz0ajDt16miwdbT9QdD2JwT?type=svg" alt=""></a></p>
<p>Stesse chiamate lato cliente, basta costruire la catena di decoratori in modo opportuno!</p>
</section><section>
<h2 id="file-ed-encoding">File ed encoding</h2>
<h3 id="il-contenuto-dei-file">Il contenuto dei file</h3>
<p>Supponiamo utilizziate un <code>FileOutputStream</code> per scrivere in sequenza i numeri da 0 a 20(escluso)</p>
<ul>
<li>Che cosa avete realmente scritto?</li>
<li>avete scritto i byte da zero a 19</li>
<li>In esadecimale, <code>0x000102030405060708090A0B0C0D0E0F10111213</code></li>
<li><strong>Non</strong> avete scritto il testo <code>012345678910111213141516171819</code></li>
</ul>
<h4 id="i-file-sono-sequenze-di-byte">I file sono sequenze di byte</h4>
<p>Per fare input/output occorre stabilire:</p>
<ul>
<li>Una conversione dalla struttura dati che stiamo manipolando a sequenza di byte (<em>encoding</em>)</li>
<li>Una conversione da sequenza di byte a struttura dati (<em>decoding</em>)</li>
</ul>
</section><section>
<h2 id="cosa-succede-se-ignoro-lencoding">Cosa succede se ignoro l’encoding?</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">ReadWriteWithoutEncoding</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">final</span> <span style="color:#000">String</span> <span style="color:#000">FILE_NAME</span> <span style="color:#000">=</span> <span style="color:#c41a16">"test-output.txt"</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span> (<span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">out</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">FileOutputStream</span>(<span style="color:#000">FILE_NAME</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Writing..."</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">b</span> <span style="color:#000">=</span> <span style="color:#000">0</span>; <span style="color:#000">b</span> <span style="color:#000">&lt;</span> <span style="color:#000">1000</span>; <span style="color:#000">b</span><span style="color:#000">++</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">print</span>(<span style="color:#000">b</span> <span style="color:#000">+</span> <span style="color:#c41a16">" "</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#000">out</span>.<span style="color:#836c28">write</span>(<span style="color:#000">b</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Done."</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span> (<span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">in</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">FileInputStream</span>(<span style="color:#000">FILE_NAME</span>)) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Reading..."</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">for</span> (<span style="color:#a90d91">var</span> <span style="color:#000">read</span> <span style="color:#000">=</span> <span style="color:#000">in</span>.<span style="color:#836c28">read</span>(); <span style="color:#000">read</span> <span style="color:#000">!=</span> <span style="color:#000">-</span><span style="color:#000">1</span>; <span style="color:#000">read</span> <span style="color:#000">=</span> <span style="color:#000">in</span>.<span style="color:#836c28">read</span>()) {
</span></span><span style="display:flex;"><span>                <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">print</span>(<span style="color:#000">read</span> <span style="color:#000">+</span> <span style="color:#c41a16">" "</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Done."</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// Quick method to read the file as a text string</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Actual file content:"</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#a90d91">new</span> <span style="color:#000">String</span>(<span style="color:#000">Files</span>.<span style="color:#836c28">readAllBytes</span>(<span style="color:#000">Path</span>.<span style="color:#836c28">of</span>(<span style="color:#000">FILE_NAME</span>))));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="esecuzione">Esecuzione</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span>Writing...
</span></span><span style="display:flex;"><span><span style="color:#1c01ce">0</span> <span style="color:#1c01ce">1</span> <span style="color:#1c01ce">2</span> <span style="color:#1c01ce">3</span> <span style="color:#1c01ce">4</span> ... <span style="color:#1c01ce">255</span> <span style="color:#1c01ce">256</span> <span style="color:#1c01ce">257</span> <span style="color:#1c01ce">258</span> <span style="color:#1c01ce">259</span> <span style="color:#1c01ce">260</span> <span style="color:#1c01ce">261</span> <span style="color:#1c01ce">262</span> <span style="color:#1c01ce">263</span> <span style="color:#1c01ce">264</span> <span style="color:#1c01ce">265</span> <span style="color:#1c01ce">266</span> <span style="color:#1c01ce">267</span> <span style="color:#1c01ce">268</span> <span style="color:#1c01ce">269</span> <span style="color:#1c01ce">270</span> <span style="color:#1c01ce">271</span> <span style="color:#1c01ce">272</span> ... Done.
</span></span><span style="display:flex;"><span>Reading...
</span></span><span style="display:flex;"><span><span style="color:#1c01ce">0</span> <span style="color:#1c01ce">1</span> <span style="color:#1c01ce">2</span> <span style="color:#1c01ce">3</span> <span style="color:#1c01ce">4</span> ... <span style="color:#1c01ce">255</span> <span style="color:#1c01ce">0</span> <span style="color:#1c01ce">1</span> <span style="color:#1c01ce">2</span> <span style="color:#1c01ce">3</span> <span style="color:#1c01ce">4</span> <span style="color:#1c01ce">5</span> <span style="color:#1c01ce">6</span> <span style="color:#1c01ce">7</span> <span style="color:#1c01ce">8</span> <span style="color:#1c01ce">9</span> <span style="color:#1c01ce">10</span> <span style="color:#1c01ce">11</span> <span style="color:#1c01ce">12</span> <span style="color:#1c01ce">13</span> <span style="color:#1c01ce">14</span> <span style="color:#1c01ce">15</span> <span style="color:#1c01ce">16</span> ... Done.
</span></span><span style="display:flex;"><span>Actual file content:
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span> !<span style="color:#c41a16">"#</span>$<span style="color:#c41a16">%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ
</span></span></span><span style="display:flex;"><span><span style="color:#c41a16">[\]^_`abcdefghijklmnopqrstuvwxyz{|}~����������������������������������������������������
</span></span></span><span style="display:flex;"><span><span style="color:#c41a16">���������������������������������������������������������������������������� 
</span></span></span><span style="display:flex;"><span><span style="color:#c41a16"> !"</span><span style="color:#177500">#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ</span>
</span></span><span style="display:flex;"><span><span style="color:#000">[</span><span style="color:#c41a16">\]</span>^_<span style="color:#c41a16">`</span>abcdefghijklmnopqrstuvwxyz<span style="color:#000">{</span>|<span style="color:#000">}</span>~����������������������������������������������������
</span></span><span style="display:flex;"><span>���������������������������������������������������������������������������� 
</span></span><span style="display:flex;"><span> !<span style="color:#c41a16">"#</span>$<span style="color:#c41a16">%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ
</span></span></span><span style="display:flex;"><span><span style="color:#c41a16">[\]^_`abcdefghijklmnopqrstuvwxyz{|}~����������������������������������������������������
</span></span></span><span style="display:flex;"><span><span style="color:#c41a16">���������������������������������������������������������������������������� 
</span></span></span><span style="display:flex;"><span><span style="color:#c41a16"> !"</span><span style="color:#177500">#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ</span>
</span></span><span style="display:flex;"><span><span style="color:#000">[</span><span style="color:#c41a16">\]</span>^_<span style="color:#c41a16">`</span>abcdefghijklmnopqrstuvwxyz<span style="color:#000">{</span>|<span style="color:#000">}</span>~����������������������������������������������������
</span></span><span style="display:flex;"><span>����������������������������������������������������
</span></span></code></pre></div><p><strong>Non avete scritto testo!</strong></p>
<p>Avete scritto il valore in <code>byte</code> della parte <em>meno significativa</em> degli interi che avete passato</p>
<ul>
<li>Per questo in lettura “riparte” da <code>0</code> dopo <code>255</code> (massimo valore di un byte senza segno)</li>
<li>Per questo, se letto come stringa, vi trovate un testo non comprensibile!
<ul>
<li>Non avete scritto caratteri di testo, avete scritto bytes!</li>
<li>E nessuno ha spiegato come convertire da/a testo</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="conversione-da-byte-a-testo">Conversione da byte a testo</h2>
<p>Per interpretare i byte come sequenza di caratteri,
occorre usare una <em>tabella di conversione</em>
(<strong>character encoding</strong>, <code>Charset</code> in Java)</p>
<h4 id="nota">Nota</h4>
<ul>
<li>si applica anche importante anche alla rappresentazione <strong>in memoria</strong> dei caratteri!</li>
<li>La memoria contiene <code>byte</code>, se vediamo delle stringhe di testo è perchè avviene un <em>encoding</em></li>
</ul>
<h3 id="formati-notevoli-di-character-encoding">Formati notevoli di character encoding</h3>
<ul>
<li><strong>ASCII</strong> (RFC 20)
<ul>
<li>l’encoding che usa il linguaggio C per i <code>char</code></li>
<li>1 byte per carattere (massimo 256 caratteri)</li>
</ul>
</li>
<li><strong>UTF-8</strong> (RFC 3629)
<ul>
<li>Standard di fatto sul web e per il codice, <em>encoding da usare per sorgenti Java</em></li>
<li>da 1 a 4 byte per carattere</li>
<li>Codifica 1.112.064 simboli</li>
</ul>
</li>
<li><strong>UTF-16</strong> (RFC 2781)
<ul>
<li>Encoding in memoria delle <code>String</code> in Java</li>
<li>2 o 4 byte per carattere</li>
<li>Codifica 1.112.064 simboli</li>
</ul>
</li>
<li><strong>ISO/IEC 8859-1:1998</strong> o semplicemente <strong>ISO Latin</strong>
<ul>
<li>Encoding di default del testo in Windows</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="stream-di-caratteri-reader-e-writer">Stream di caratteri: <code>Reader</code> e <code>Writer</code></h2>
<p>(<code>In</code>|<code>Out</code>)<code>putStream</code>s sono pensati per gestire direttamente byte, non caratteri.</p>
<p>Molto spesso abbiamo però bisogno di leggere o scrivere stringhe di testo!</p>
<p><code>Reader</code> e <code>Writer</code> sono pensati per gestire “stream di caratteri” invece che stream di <code>byte</code></p>
<ul>
<li>Noi ci interesseremo solo di <code>Reader</code>:
per la scrittura in formato carattere possiamo infatti usare <code>PrintStream</code>
<ul>
<li>(che, purtroppo, non ha un omologo stream di input)</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="esempio-con-inputstreamreader">Esempio con <code>InputStreamReader</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseBufferedPrintStream</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">final</span> <span style="color:#000">File</span> <span style="color:#000">FILE</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">File</span>(<span style="color:#c41a16">"test-output.txt"</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// string -&gt; buffer -&gt;  compress -&gt; file</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span> (<span style="color:#a90d91">final</span> <span style="color:#000">PrintStream</span> <span style="color:#000">fileOut</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">PrintStream</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">new</span> <span style="color:#000">BufferedOutputStream</span>(<span style="color:#a90d91">new</span> <span style="color:#000">FileOutputStream</span>(<span style="color:#000">FILE</span>)), <span style="color:#177500">// better performance</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">false</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span> <span style="color:#177500">// Always specify how to translate text into bytes and viceversa</span>
</span></span><span style="display:flex;"><span>        )) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">fileOut</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Hey, this is my first printed line in a text file!"</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#000">fileOut</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Here is another text line"</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Writing completed!"</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// To read, we must reverse the operations:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// file -&gt; decompress -&gt; string (optionally, with a buffer)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">try</span> (
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">inputReader</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">BufferedReader</span>(
</span></span><span style="display:flex;"><span>                <span style="color:#a90d91">new</span> <span style="color:#000">InputStreamReader</span>(<span style="color:#a90d91">new</span> <span style="color:#000">FileInputStream</span>(<span style="color:#000">FILE</span>), <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span>)
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>        ) {
</span></span><span style="display:flex;"><span>            <span style="color:#a90d91">for</span> (<span style="color:#000">String</span> <span style="color:#000">line</span> <span style="color:#000">=</span> <span style="color:#000">inputReader</span>.<span style="color:#836c28">readLine</span>(); <span style="color:#000">line</span> <span style="color:#000">!=</span> <span style="color:#a90d91">null</span>; <span style="color:#000">line</span> <span style="color:#000">=</span> <span style="color:#000">inputReader</span>.<span style="color:#836c28">readLine</span>()) {
</span></span><span style="display:flex;"><span>                <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Read line: "</span> <span style="color:#000">+</span> <span style="color:#000">line</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="utility-files">Utility <code>Files</code></h2>
<p>Nella maggior parte dei casi,
vogliamo salvare e caricare i nostri dati scrivendo e leggendo un intero file.</p>
<ul>
<li>Scrivere una stringa di testo in un file</li>
<li>Leggere un file di testo riga per riga</li>
<li>Scrivere un binario che abbiamo convertito in <code>byte[]</code> (ad esempio un’immagine)</li>
</ul>
<p>La classe <code>Files</code> contiene diversi metodi convenienti per leggere e scrivere file con poco codice:</p>
<ul>
<li><code>Paths.get(String)</code> ottiene un oggetto di tipo <code>Path</code> da un nome
<ul>
<li>simile al costruttore di <code>File</code> <code>File(String)</code></li>
</ul>
</li>
<li><code>Files.write(Path, byte[])</code> scrive un array di <code>byte</code> dentro il <code>Path</code></li>
<li><code>Files.write(Path, Iterable&lt;? extends Charsequence&gt;, Charset)</code> scrive una collezione di stringhe dentro il <code>Path</code>,
traducendo le stringhe in <code>byte</code> usando il <code>Charset</code> fornito</li>
<li><code>Files.writeString(Path, String, Charset)</code> scrive una collezione di stringhe dentro il <code>Path</code>,
traducendo le stringhe in <code>byte</code> usando il <code>Charset</code> fornito</li>
<li><code>byte[] Files.readAllBytes(Path)</code> legge il contenuto di <code>Path</code> e lo restituisce come <code>byte[]</code></li>
<li><code>List&lt;String&gt; Files.readAllLines(Path, Charsets)</code> legge il contenuto di <code>Path</code> e lo restituisce come <code>List&lt;String&gt;</code>,
una stringa per ogni linea,
interpretando i <code>byte</code> del file come testo usando il <code>Charset</code> fornito</li>
<li><code>String Files.readString(Path, Charsets)</code> legge il contenuto di <code>Path</code> e lo restituisce come singola String,
interpretando i <code>byte</code> del file come testo usando il <code>Charset</code> fornito</li>
</ul>
</section><section>
<h2 id="esempio-duso-di-files">Esempio d’uso di <code>Files</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.io.IOException</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.nio.charset.StandardCharsets</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.nio.file.Files</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.nio.file.Path</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.nio.file.Paths</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.Arrays</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.List</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseFilesUtilities</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#a90d91">final</span> <span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">args</span>) <span style="color:#a90d91">throws</span> <span style="color:#000">IOException</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">bytes</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#a90d91">byte</span><span style="color:#000">[]</span> { <span style="color:#000">1</span>, <span style="color:#000">2</span>, <span style="color:#000">-</span><span style="color:#000">128</span>, <span style="color:#000">99</span> };
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Path</span> <span style="color:#000">binary</span> <span style="color:#000">=</span> <span style="color:#000">Paths</span>.<span style="color:#836c28">get</span>(<span style="color:#c41a16">"binary-file.dat"</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">Files</span>.<span style="color:#836c28">write</span>(<span style="color:#000">binary</span>, <span style="color:#000">bytes</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Read bytes: "</span> <span style="color:#000">+</span> <span style="color:#000">Arrays</span>.<span style="color:#836c28">toString</span>(<span style="color:#000">Files</span>.<span style="color:#836c28">readAllBytes</span>(<span style="color:#000">binary</span>)));
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">List</span><span style="color:#000">&lt;</span><span style="color:#000">String</span><span style="color:#000">&gt;</span> <span style="color:#000">dante</span> <span style="color:#000">=</span> <span style="color:#000">List</span>.<span style="color:#836c28">of</span>(
</span></span><span style="display:flex;"><span>            <span style="color:#c41a16">"Tanto gentile e tanto onesta pare"</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#c41a16">"la donna mia, quand'ella altrui saluta"</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#c41a16">"ch'ogne lingua deven tremando muta"</span>
</span></span><span style="display:flex;"><span>        );
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Path</span> <span style="color:#000">text</span> <span style="color:#000">=</span> <span style="color:#000">Paths</span>.<span style="color:#836c28">get</span>(<span style="color:#c41a16">"text-file.txt"</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">Files</span>.<span style="color:#836c28">write</span>(<span style="color:#000">text</span>, <span style="color:#000">dante</span>, <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span>); <span style="color:#177500">// Always specify the Charset!</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Read all file lines:\n"</span> <span style="color:#000">+</span> <span style="color:#000">Files</span>.<span style="color:#836c28">readAllLines</span>(<span style="color:#000">text</span>, <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Read the file as string:\n"</span> <span style="color:#000">+</span> <span style="color:#000">Files</span>.<span style="color:#836c28">readString</span>(<span style="color:#000">text</span>, <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#000">Files</span>.<span style="color:#836c28">writeString</span>(<span style="color:#000">text</span>, <span style="color:#c41a16">"this is\na multiline string!"</span>, <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Read all file lines:\n"</span> <span style="color:#000">+</span> <span style="color:#000">Files</span>.<span style="color:#836c28">readAllLines</span>(<span style="color:#000">text</span>, <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Read the file as string:\n"</span> <span style="color:#000">+</span> <span style="color:#000">Files</span>.<span style="color:#836c28">readString</span>(<span style="color:#000">text</span>, <span style="color:#000">StandardCharsets</span>.<span style="color:#836c28">UTF_8</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h1 id="caricamento-da-classpath">Caricamento da classpath</h1>
</section><section>
<h2 id="organizzazione-di-un-progetto-gradle-con-risorse">Organizzazione di un progetto Gradle con risorse</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span>├── src
</span></span><span style="display:flex;"><span>│   ├── main
</span></span><span style="display:flex;"><span>│   │   ├── java
</span></span><span style="display:flex;"><span>│   │   └── resources
</span></span><span style="display:flex;"><span>│   └── test
</span></span><span style="display:flex;"><span>│       ├── java
</span></span><span style="display:flex;"><span>│       └── resources
</span></span><span style="display:flex;"><span>├── build.gradle.kts
</span></span><span style="display:flex;"><span>└── settings.gradle.kts
</span></span></code></pre></div><ul>
<li>Le cartelle <code>src/[main|test]/resources</code> contengono le risorse del progetto opportunamente organizzate
<ul>
<li>Per risorse si intendono icone, file di testo, video, immagini, modelli 3D e qualunque cosa sia necessaria al corretto funzionamento del programma ma non sia una libreria o un file sorgente.</li>
</ul>
</li>
<li>Il contenuto di <code>resources</code> <strong>diventa parte del classpath</strong>!
<ul>
<li>viene anche copiato nel file Jar finale</li>
<li>$\Rightarrow$ dobbiamo imparare a caricare quelle risorse direttamente dal jar</li>
<li>Potremo così dare solo il nostro jar dell’applicazione, senza ulteriori risorse</li>
</ul>
</li>
</ul>
</section><section>
<!-- this file includes generated content. Do not edit. Edit content/14-io/generator.md, instead. -->
<h2 id="risorse-caricate-dal-classpath">Risorse caricate dal classpath</h2>
<ul>
<li>
<p>Abbiamo visto finora il <em>classpath</em> come l’insieme dei <em>percorsi</em> dove la virtual machine va a cercare le classi da caricare</p>
<ul>
<li>Come abbiamo visto usando l’opzione <code>-cp</code> di <code>java</code> e <code>javac</code>, il classpath può contenere indifferentemente dei path o dei JAR (o anche degli zip)</li>
</ul>
</li>
<li>
<p>Esso includerà tipicamente anche le risorse del progetto, i JAR delle dipendenze importate, etc.</p>
</li>
<li>
<p>Come possiamo accedere a queste risorse in modo uniforme?</p>
<ul>
<li>Ossia caricarle sia che si trovino sul file system, sia che si trovino nel JAR eseguibile, sia che vengano incluse in un JAR di risorse separato.</li>
</ul>
</li>
<li>
<p>Java fornisce un’utilità per caricare risorse dal <strong>classpath</strong></p>
<ul>
<li>Approccio <strong>location-independent</strong>: non importa dove il codice venga eseguito fin tanto che l’ambiente viene correttamente impostato per trovare le risorse.</li>
</ul>
</li>
</ul>
</section><section>
<h3 id="classloadergetsystemresourceasstreamstring"><code>ClassLoader.getSystemResource</code>(<code>AsStream</code>)<code>(String)</code></h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">abstract</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">ClassLoader</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">ClassLoader</span> <span style="color:#000">getSystemClassLoader</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">URL</span> <span style="color:#000">getSystemResource</span>(<span style="color:#000">String</span> <span style="color:#000">name</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">InputStream</span> <span style="color:#000">getSystemResourceAsStream</span>(<span style="color:#000">String</span> <span style="color:#000">name</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a90d91">public</span> <span style="color:#000">URL</span> <span style="color:#000">getResource</span>(<span style="color:#000">String</span> <span style="color:#000">name</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#177500">// ...</span>
</span></span></code></pre></div><ul>
<li>Un <strong>class loader</strong> (istanza di <code>ClassLoader</code>) è un’oggetto responsabile del <em>caricamento di classi e risorse</em>
<ul>
<li>ogni class loader ha un class loader padre, per sfruttare un meccanismo di delega</li>
<li>il parent di default è il <strong>system class loader</strong> che carica classi e risorse <em>dal classpath</em></li>
</ul>
</li>
<li>Una <strong>risorsa di sistema</strong> (system resource) è una risorsa “built-in” del sistema software, oppure disponibile nel sistema host (ad es. nel filesystem locale)
<ul>
<li>Per esempio, l’implementazione di base ricerca nel <code>CLASSPATH</code></li>
</ul>
</li>
<li>L’argomento di <code>getSystemResource</code> e <code>getSystemResourceAsStream</code> è il <strong>nome di una risorsa</strong> (<strong>non un percorso del filesystem!</strong>), che è una stringa separata da <code>/</code> che identifica la risorsa
<ul>
<li>L’interpretazione del nome della risorsa dipende dall’implementazione</li>
<li>Il system class loader usa il nome come un path per cercare la risorsa a partire dalle entry del classpath</li>
</ul>
</li>
<li><code>ClassLoader.getSystemResource()</code> equivale a <code>ClassLoader.getSystemClassLoader().getResource()</code></li>
</ul>
</section><section>
<h3 id="risorse-caricate-dal-classpath----esempi">Risorse caricate dal classpath – Esempi</h3>
<h4 id="caricamento-di-file">Caricamento di File</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">final</span> <span style="color:#000">InputStream</span> <span style="color:#000">in</span> <span style="color:#000">=</span> <span style="color:#000">ClassLoader</span>.<span style="color:#836c28">getSystemResourceAsStream</span>(<span style="color:#c41a16">"/settings/settings"</span>);
</span></span><span style="display:flex;"><span><span style="color:#a90d91">final</span> <span style="color:#000">BufferedReader</span> <span style="color:#000">br</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">BufferedReader</span>(<span style="color:#a90d91">new</span> <span style="color:#000">InputStreamReader</span>(<span style="color:#000">in</span>));
</span></span><span style="display:flex;"><span><span style="color:#a90d91">final</span> <span style="color:#000">String</span> <span style="color:#000">line</span> <span style="color:#000">=</span> <span style="color:#000">br</span>.<span style="color:#836c28">readLine</span>();
</span></span><span style="display:flex;"><span><span style="color:#000">in</span>.<span style="color:#836c28">close</span>();
</span></span></code></pre></div><h4 id="caricamento-di-immagini">Caricamento di Immagini</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">final</span> <span style="color:#000">URL</span> <span style="color:#000">imgURL</span> <span style="color:#000">=</span> <span style="color:#000">ClassLoader</span>.<span style="color:#836c28">getSystemResource</span>(<span style="color:#c41a16">"/images/gandalf.jpg"</span>);
</span></span><span style="display:flex;"><span><span style="color:#a90d91">final</span> <span style="color:#000">ImageIcon</span> <span style="color:#000">icon</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">ImageIcon</span>(<span style="color:#000">imgURL</span>);
</span></span><span style="display:flex;"><span><span style="color:#a90d91">final</span> <span style="color:#000">JLabel</span> <span style="color:#000">lab1</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">JLabel</span>(<span style="color:#000">icon</span>);
</span></span></code></pre></div><p>Progetto di esempio:
<a href="https://github.com/unibo-oop/example-with-get-resources">https://github.com/unibo-oop/example-with-get-resources</a></p>
</section><section>
<h2 id="installazione-delle-impostazioni-per-utente">Installazione delle impostazioni per-utente</h2>
<h4 id="motivazione">Motivazione</h4>
<p>Spesso un software ha necessità di caricare al primo avvio delle <em>impostazioni di default</em>, quindi lasciare l’utente libero di modificarle e, se avviato successivamente caricare quelle scelte dall’utente. In caso di sistema multiutente, le impostazioni saranno diverse per ciascuno.</p>
<h4 id="strategia">Strategia</h4>
<ul>
<li>Si sceglie una cartella nella <strong>home folder dell’utente</strong> dove salvare le impostazioni.
<ul>
<li>È norma consolidata creare una cartella <code>.nomeprogramma</code>.</li>
</ul>
</li>
<li>Al primo avvio, si verifica se tale cartella esista e se contenga i file di configurazione previsti.
<ul>
<li>Se non è presente, o se non sono presenti e leggibili alcuni i file, si procede a caricare nella cartella di destinazione i file di default dal JAR usando <code>getResource()</code>.</li>
</ul>
</li>
</ul>
</section><section>
<h1 id="standard-per-la-serializzazione-di-oggetti">Standard per la serializzazione di oggetti</h1>
</section><section>
<h2 id="formati-standard-per-la-serializzazione-di-oggetti">Formati standard per la serializzazione di oggetti</h2>
<p>Per scrivere oggetti (a parte le <code>String</code>),
abbiamo bisogno di convertire gli oggetti in <code>byte[]</code> o in <code>String</code>
(<em>serializzare</em>),
ossia nei formati che sappiamo scrivere.</p>
<p>Allo stesso modo, sapendo leggere solo <code>byte[]</code> oppure <code>String</code>,
dovremo avere modo di <em>deserializzare</em> questi flussi in oggetti</p>
<p>Esistono sistemi di conversione sia binaria
(oggetto $\xrightarrow{\text{serializzazione}}$ <code>byte[]</code> $\xrightarrow{\text{deserializzazione}}$ oggetto)</p>
<ul>
<li>ad esempio, ProtocolBuffers</li>
</ul>
<p>che testuale
(oggetto $\xrightarrow{\text{serializzazione}}$ <code>String</code> $\xrightarrow{\text{deserializzazione}}$ oggetto)</p>
<ul>
<li>JavaScript Object Notation – JSON (RFC 7159)
<ul>
<li>Nato in seno a JavaScript (che non c’entra nulla con Java)</li>
<li>Molto usato in ambito web</li>
<li>Librerie Java Jackson e Guava</li>
</ul>
</li>
<li>YAML Ain’t Markup Language – YAML
<ul>
<li>Superset di JSON dalla versione 1.2</li>
<li>Supporto per funzioni avanzate (e.g. anchoring)</li>
<li>Molto usato per file di configurazione complessi</li>
</ul>
</li>
</ul>
<p>Standard testuali sono più <em>facilmente leggibili</em>,
e, laddove le prestazioni e lo spazio non siano stringenti, preferiti</p>
</section>

  


</div>
      

    </div>
<script type="text/javascript" src="/reveal-hugo/object-assign.js"></script>

<a href="/reveal-js/dist/print/" id="print-location" style="display: none;"></a>

<script type="application/json" id="reveal-hugo-site-params">{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"custom_theme_options":{"enablesourcemap":true,"targetpath":"css/custom-theme.css"},"height":"900","highlight_theme":"default","history":true,"mermaid":[{"startOnLoad":false}],"slide_number":true,"theme":"white","transition":"slide","transition_speed":"fast","width":"1440"}</script>
<script type="application/json" id="reveal-hugo-page-params">null</script>

<script src="/reveal-js/dist/reveal.js"></script>


  
  
  <script type="text/javascript" src="/reveal-js/plugin/markdown/markdown.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/highlight/highlight.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/zoom/zoom.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/notes/notes.js"></script>
  
  
  <script type="text/javascript" src="/reveal-js/plugin/notes/notes.js"></script>




<script type="text/javascript">
  
  
  function camelize(map) {
    if (map) {
      Object.keys(map).forEach(function(k) {
        newK = k.replace(/(\_\w)/g, function(m) { return m[1].toUpperCase() });
        if (newK != k) {
          map[newK] = map[k];
          delete map[k];
        }
      });
    }
    return map;
  }

  var revealHugoDefaults = { center: true, controls: true, history: true, progress: true, transition: "slide" };

  var revealHugoPlugins = { 
    plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealZoom ]
   };
  var revealHugoSiteParams = JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);
  var revealHugoPageParams = JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);
  
  var options = Object.assign({},
    camelize(revealHugoDefaults),
    camelize(revealHugoSiteParams),
    camelize(revealHugoPageParams),
    camelize(revealHugoPlugins));
  Reveal.initialize(options);
</script>






  

  

  

  

  

  

  
    
  

  
    
  

  

  
    
  

  

  
    
  

  

  

  
    
  

  
    
  

  

  

  
    
  

  
    
  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  



  <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({"startOnLoad":false});

    let render = (event) => {
      let mermaidElems = event.currentSlide.querySelectorAll('.mermaid');
      if (!mermaidElems.length){
          return
      }
      mermaidElems.forEach(mermaidElem => {
          let processed = mermaidElem.getAttribute('data-processed');
          if (!processed){
              
              mermaid.init(undefined, mermaidElem);
          }
      });
    };
    
    render({currentSlide: Reveal.getCurrentSlide()});

    Reveal.on('slidechanged', render);
    Reveal.on('ready', render);
  </script>

    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>

<script type="text/javascript" id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<script>
  if (/.*?(\?|&)print-pdf/.test(window.location.toString())) {
      var ytVideos = document.getElementsByTagName("iframe")
      for (let i = 0; i < ytVideos.length; i++) {
          var videoFrame = ytVideos[i]
          var isYouTube = /^https?:\/\/(www.)youtube\.com\/.*/.test(videoFrame.src)
          if (isYouTube) {
              console.log(`Removing ${videoFrame.src}`)
              var parent = videoFrame.parentElement
              videoFrame.remove()
              var p = document.createElement('p')
              p.append(
                  document.createTextNode(
                      "There was an embedded video here, but it is disabled in the printed version of the slides."
                  )
              )
              p.append(document.createElement('br'))
              p.append(
                  document.createTextNode(
                      `Visit instead ${
                          videoFrame.src
                      } or ${
                          videoFrame.src.replace(
                              /(^https?:\/\/(www.)youtube\.com)\/(embed\/)(\w+).*/,
                              "https://www.youtube.com/watch?v=$4"
                          )
                      }`
                  )
              )
              parent.appendChild(p)
          }
      }
  }
</script>

    
  

</body></html>