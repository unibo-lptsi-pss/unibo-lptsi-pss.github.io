<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
<title>Progettazione e Sviluppo del Software</title>
<meta name="description" content="Progettazione e Sviluppo del Software, Tecnologie dei Sistemi Informatici">
<meta name="author" content="Danilo Pianini">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><link rel="stylesheet" href="/reveal-js/dist/reset.css">
<link rel="stylesheet" href="/reveal-js/dist/reveal.css">
  <link rel="stylesheet" href="/css/custom-theme.min.c5d5307c22aeba26e5f63813bdbc90c5483e809383467a8e6f523d7f756010c5.css" id="theme"><link rel="stylesheet" href="/highlight-js/default.min.css">
<link href="https://fonts.googleapis.com/css?family=Roboto Mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Oxygen Mono" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Ubuntu Mono" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">

  </head>
  <body>
    
    <div class="reveal">
      <div class="slides">
  

    <section><h1 id="generici">Generici</h1>
<h4 id="progettazione-e-sviluppo-del-software">Progettazione e Sviluppo del Software</h4>
<h4 id="cdl-tecnologie-dei-sistemi-informatici">C.D.L. Tecnologie dei Sistemi Informatici</h4>
<h3 id="danilo-pianini"><a href="mailto:danilo.pianini@unibo.it">Danilo Pianini — <code>danilo.pianini@unibo.it</code></a></h3>
<h3 id="gianluca-aguzzi"><a href="mailto:gianluca.aguzzi@unibo.it">Gianluca Aguzzi — <code>gianluca.aguzzi@unibo.it</code></a></h3>
<h3 id="angelo-filaseta"><a href="mailto:angelo.filaseta@unibo.it">Angelo Filaseta — <code>angelo.filaseta@unibo.it</code></a></h3>
<p>Compiled on: 2025-10-30
 — <a href="?print-pdf&amp;pdfSeparateFragments=false"><i class="fa fa-print" aria-hidden="true"></i> versione stampabile</a></p>
<p><a href=".."><i class="fa fa-undo" aria-hidden="true"></i> back</a></p>
</section><section>
<h2 id="outline">Outline</h2>
<h3 id="goal-della-lezione">Goal della lezione</h3>
<ul>
<li>Illustrare il <em>problema delle collezioni polimorfiche</em></li>
<li>Discutere il concetto di <em>polimorfismo parametrico</em></li>
<li>Illustrare i <em>Generici</em> di Java e alcuni loro vari dettagli</li>
</ul>
<h3 id="argomenti">Argomenti</h3>
<ul>
<li>Collezioni con polimorfismo inclusivo</li>
<li>Classi generiche</li>
<li>Interfacce generiche</li>
<li>Metodi generici</li>
</ul>
</section><section>
<h1 id="collezioni-con-polimorfismo-inclusivo">Collezioni con polimorfismo inclusivo</h1>
<h2 id="forme-di-riuso-nella-programmazione-oo">Forme di <strong>riuso</strong> nella programmazione OO</h2>
<h3 id="composizione-e-come-caso-particolare-delegazione">Composizione (e come caso particolare, delegazione)</h3>
<p>Un oggetto è ottenuto per composizione di oggetti di altre classi</p>
<h3 id="estensione-ereditarietà">Estensione (ereditarietà)</h3>
<p>Una nuova classe è ottenuta riusando il codice di una classe pre-esistente</p>
<h3 id="polimorfismo-inclusivo-subtyping">Polimorfismo inclusivo (subtyping)</h3>
<p>Una funzionalità realizzata per lavorare su valori/oggetti del tipo <code>A</code>,
può lavorare con qualunque valore/oggetto del sottotipo <code>B</code>
(p.e., se <code>B</code> estende la classe <code>A</code>, o se <code>B</code> implementa l’interfaccia <code>A</code>)</p>
<h3 id="polimorfismo-parametrico-javac-generics-c-templates">Polimorfismo parametrico (Java/C# generics, C++ templates,..)</h3>
<p>Una funzionalità (classe o metodo)
generica è costruita in modo tale da lavorare uniformemente su valori/oggetti indipendentemente dal loro tipo:
tale tipo diventa quindi una sorta di parametro addizionale</p>
</section><section>
<h2 id="astrazioni-uniformi-con-le-classi">Astrazioni uniformi con le classi</h2>
<h3 id="astrazioni-uniformi-per-problemi-ricorrenti">Astrazioni uniformi per problemi ricorrenti</h3>
<ul>
<li>Si consideri il <em>problema specifico</em> del controllo dell’accensione di varie tipologie di dispositivi
<ul>
<li>Tale funzionalità si può fattorizzare ad esempio in una classe astratta <code>Device</code></li>
</ul>
</li>
<li>Durante lo sviluppo di vari sistemi si incontrano <em>problemi generali/ricorrenti</em> che possono trovare una soluzione comune</li>
<li>Spesso tali soluzioni sono <em>fattorizzabili in una o più interfacce/classi altamente riusabili</em> (per astrazione)
<ul>
<li><strong>Fattorizzare = mettere a fattor comune</strong>, si pensi alla matematica $AB + AC = A(B + C)$</li>
</ul>
</li>
</ul>
<h3 id="un-caso-fondamentale-le-collection">Un caso fondamentale: le <em><strong>collection</strong></em></h3>
<ul>
<li>Una <em>collection</em> è un <em>oggetto</em> il cui compito è quello di immagazzinare i <em>riferimenti</em> ad un numero (tipicamente non precisato) di altri oggetti
<ul>
<li>Fra i suoi compiti c’è quello di consentire <em>modifiche ed accessi veloci</em> all’insieme di elementi di tale collezioni</li>
<li>Varie strategie possono essere utilizzate, seguendo la <em>teoria/pratica degli algoritmi e delle strutture dati</em></li>
</ul>
</li>
</ul>
</section><section>
<h2 id="un-esempio-intvector">Un esempio: <code>IntVector</code></h2>
<h3 id="collection-intvector">Collection <code>IntVector</code></h3>
<ul>
<li>Contiene <em>serie numeriche (<strong>vettori</strong>)</em> di dimensione non nota a priori, ossia, a <em>lunghezza variabile</em>..</li>
</ul>
<p><img src="imgs/uml-int-vector-abstracted.png" alt=""></p>
</section><section>
<h2 id="useintvector"><code>UseIntVector</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseIntVector</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">s</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">final</span> <span style="color:#000">IntVector</span> <span style="color:#000">vi</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">IntVector</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// Serie di Fibonacci: fib(0)=fib(1)=1, fib(N)=fib(N-1)+fib(N-2) if N&gt;1</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">vi</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">1</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#000">vi</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">1</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">20</span>; <span style="color:#000">i</span><span style="color:#000">++</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#000">vi</span>.<span style="color:#836c28">addElement</span>(
</span></span><span style="display:flex;"><span>				<span style="color:#000">vi</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">vi</span>.<span style="color:#836c28">getLength</span>() <span style="color:#000">-</span> <span style="color:#000">1</span>) <span style="color:#000">+</span> <span style="color:#177500">// ultimo</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">vi</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">vi</span>.<span style="color:#836c28">getLength</span>() <span style="color:#000">-</span> <span style="color:#000">2</span>)   <span style="color:#177500">// penultimo</span>
</span></span><span style="display:flex;"><span>			);
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">vi</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// |1|1|2|3|5|8|13|21|34|55|89|144|233|..</span>
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// 377|610|987|1597|2584|4181|6765|10946|17711|</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="intvector--implementazione"><code>IntVector</code> – implementazione</h2>
<h3 id="collection-intvector-1">Collection <code>IntVector</code></h3>
<ul>
<li>Contiene serie numeriche (vettori) di dimensione non nota a priori</li>
<li>Realizzata <em>componendo un array che viene espanso all’occorrenza</em></li>
</ul>
<p><img src="imgs/uml-int-vector.png" alt=""></p>
</section><section>
<h2 id="intvector-pt-1"><code>IntVector</code> pt 1</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">IntVector</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">INITIAL_SIZE</span> <span style="color:#000">=</span> <span style="color:#000">10</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">int</span><span style="color:#000">[]</span> <span style="color:#000">elements</span>; <span style="color:#177500">// Deposito per gli elementi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">int</span> <span style="color:#000">size</span>;		<span style="color:#177500">// Numero di elementi</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">IntVector</span>(){		<span style="color:#177500">// Inizialmente vuoto</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#a90d91">int</span><span style="color:#000">[</span><span style="color:#000">INITIAL_SIZE</span><span style="color:#000">]</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span> <span style="color:#000">=</span> <span style="color:#000">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">addElement</span>(<span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">e</span>) {
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">if</span> (<span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span> <span style="color:#000">==</span> <span style="color:#000">elements</span>.<span style="color:#836c28">length</span>) {
</span></span><span style="display:flex;"><span>    	    <span style="color:#a90d91">this</span>.<span style="color:#836c28">expand</span>();	<span style="color:#177500">// Se non c'è più spazio..</span>
</span></span><span style="display:flex;"><span>    	}
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span><span style="color:#000">[</span><span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span><span style="color:#000">]</span> <span style="color:#000">=</span> <span style="color:#000">e</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span><span style="color:#000">++</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">getElementAt</span>(<span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">position</span>) {
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span><span style="color:#000">[</span><span style="color:#000">position</span><span style="color:#000">]</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span></code></pre></div></section><section>
<h2 id="intvector-pt-2"><code>IntVector</code> pt 2</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">getLength</span>() {
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">void</span> <span style="color:#000">expand</span>() {	<span style="color:#177500">// Raddoppio lo spazio..</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span><span style="color:#000">[]</span> <span style="color:#000">newElements</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#a90d91">int</span><span style="color:#000">[</span><span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span>.<span style="color:#836c28">length</span><span style="color:#000">*</span><span style="color:#000">2</span><span style="color:#000">]</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">i</span><span style="color:#000">=</span><span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span>.<span style="color:#836c28">length</span>; <span style="color:#000">i</span><span style="color:#000">++</span>){
</span></span><span style="display:flex;"><span>    	    <span style="color:#000">newElements</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">]</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">]</span>;
</span></span><span style="display:flex;"><span>    	}
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span> <span style="color:#000">=</span> <span style="color:#000">newElements</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#177500">//this.elements = java.util.Arrays.copyOf(this.elements, this.elements.length*2);</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">toString</span>() {
</span></span><span style="display:flex;"><span>    	<span style="color:#000">String</span> <span style="color:#000">s</span><span style="color:#000">=</span><span style="color:#c41a16">"|"</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">i</span><span style="color:#000">=</span><span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">size</span>; <span style="color:#000">i</span><span style="color:#000">++</span>){
</span></span><span style="display:flex;"><span>    	    <span style="color:#000">s</span> <span style="color:#000">=</span> <span style="color:#000">s</span> <span style="color:#000">+</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">]</span> <span style="color:#000">+</span> <span style="color:#c41a16">"|"</span>;
</span></span><span style="display:flex;"><span>    	}
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">return</span> <span style="color:#000">s</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="un-primo-passo-verso-luniformità">Un primo passo verso l’uniformità</h2>
<h3 id="solo-elenchi-di-int">Solo elenchi di <code>int</code>?</h3>
<ul>
<li>L’esperienza porterebbe subito alla necessità di progettare vettori di <code>float</code>, <code>double</code>, <code>boolean</code>, … ossia di ogni tipo primitivo</li>
<li>E poi, anche vettori di <code>String</code>, <code>Date</code>, eccetera</li>
<li>L’implementazione sarebbe analoga, ma senza possibilità di riuso..</li>
</ul>
<h3 id="collection-uniformi-monomorfiche">Collection uniformi “monomorfiche”</h3>
<ul>
<li>Una prima soluzione del problema la si ottiene sfruttando il polimorfismo inclusivo e la filosofia “everything is an object” (incluso l’uso dell’autoboxing dei tipi primitivi)</li>
<li>Si realizza unicamente un <code>ObjectVector</code>, semplicemente sostituendo <code>int</code> con <code>Object</code></li>
<li>Si inserisce qualunque elemento (via upcast implicito)
<ul>
<li><code>ObjectVector</code> è <em>monomorfica</em> in quanto “vede” un solo tipo, <code>Object</code> (sebbene i riferimenti agli <code>Object</code> siano <em>polimorfici</em>)</li>
</ul>
</li>
<li>Quando si riottiene un valore serve un downcast esplicito</li>
</ul>
</section><section>
<h2 id="da-intvector-a-objectvector">Da <code>IntVector</code> a <code>ObjectVector</code></h2>
<p><img src="imgs/uml-obj-vector.png" alt=""></p>
</section><section>
<h2 id="useobjectvector"><code>UseObjectVector</code></h2>
<ul>
<li>NOTA: <strong>necessità di downcast espliciti</strong></li>
</ul>
<div class="smaller">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseObjectVector</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">s</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// Serie di Fibonacci</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">final</span> <span style="color:#000">ObjectVector</span> <span style="color:#000">vobj</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">ObjectVector</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// fib(0)=fib(1)=1, fib(N)=fib(N-1)+fib(N-2) if N&gt;1</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">vobj</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">1</span>); <span style="color:#177500">// grazie all'autoboxing</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">vobj</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">1</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">20</span>; <span style="color:#000">i</span><span style="color:#000">++</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#000">vobj</span>.<span style="color:#836c28">addElement</span>( <span style="color:#177500">// servono downcast specifici</span>
</span></span><span style="display:flex;"><span>			(<span style="color:#000">Integer</span>) <span style="color:#000">vobj</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">vobj</span>.<span style="color:#836c28">getLength</span>() <span style="color:#000">-</span> <span style="color:#000">1</span>)
</span></span><span style="display:flex;"><span>					<span style="color:#000">+</span> (<span style="color:#000">Integer</span>) <span style="color:#000">vobj</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">vobj</span>.<span style="color:#836c28">getLength</span>() <span style="color:#000">-</span> <span style="color:#000">2</span>));
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">vobj</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// |1|1|2|3|5|8|13|21|34|55|89|144|233|..</span>
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// 377|610|987|1597|2584|4181|6765|10946|17711|</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// Altro esempio</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">final</span> <span style="color:#000">ObjectVector</span> <span style="color:#000">vobj2</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">ObjectVector</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#000">vobj2</span>.<span style="color:#836c28">addElement</span>(<span style="color:#c41a16">"Prova"</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#000">vobj2</span>.<span style="color:#836c28">addElement</span>(<span style="color:#c41a16">"di"</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#000">vobj2</span>.<span style="color:#836c28">addElement</span>(<span style="color:#c41a16">"vettore"</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#000">vobj2</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">Object</span>());
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">vobj2</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#000">String</span> <span style="color:#000">str</span> <span style="color:#000">=</span> (<span style="color:#000">String</span>) <span style="color:#000">vobj2</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">1</span>); <span style="color:#177500">// "di"</span>
</span></span><span style="display:flex;"><span>		<span style="color:#177500">// String str2 = (String)vobj2.getElementAt(3); // Exception</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></div>
</section><section>
<h2 id="la-necessità-di-un-approccio-a-polimorfismo-parametrico">La necessità di un approccio a polimorfismo parametrico</h2>
<h3 id="prima-di-java-5">Prima di Java 5</h3>
<ul>
<li>Questo era l’approccio standard alla costruzione di collection</li>
<li>Java Collection Framework — una libreria fondamentale</li>
</ul>
<h3 id="problema">Problema</h3>
<ul>
<li>Con questo approccio, nel codice Java risultavano molti usi di oggetti simili a <code>ObjectVector</code> o <code>ObjectList</code></li>
<li>Si perdeva molto facilmente traccia di quale fosse il contenuto..
<ul>
<li>contenevano oggetti vari? solo degli <code>Integer</code>? solo delle <code>String</code>?</li>
</ul>
</li>
<li>Il codice conteneva spesso dei downcast sbagliati, e quindi molte applicazioni Java fallivano generando dei <code>ClassCastException</code></li>
</ul>
<h3 id="più-in-generale">Più in generale</h3>
<p>Il problema si manifesta ogni volta che voglio collezionare oggetti il cui tipo non è noto a priori, ma potrebbe essere soggetto a polimorfismo inclusivo</p>
</section><section>
<h2 id="polimorfismo-parametrico">Polimorfismo parametrico</h2>
<h3 id="idea-di-base">Idea di base</h3>
<ul>
<li>Dato un frammento di codice <code>F</code> che lavora su un certo tipo, diciamo <code>String</code>, se può lavorare <em>in modo uniforme</em> su altri tipi…</li>
<li>… allora lo si rende parametrico, sostituendo a <code>String</code> una sorta di variabile o parametro <code>X</code> (chiamata <em><strong>type variable</strong></em> o <em><strong>type parameter</strong></em>, ossia una variabile/parametro che denota un tipo)
<ul>
<li>A questo punto, quando serve il frammento di codice istanziato sulle stringhe, si usa <code>F&lt;String&gt;</code>, ossia si richiede che <code>X</code> diventi <code>String</code></li>
<li>Quando serve il frammento di codice istanziato sugli Integer, si usa <code>F&lt;Integer&gt;</code></li>
<li>Il codice che usa tale <strong>polimorfismo parametrico</strong> è <em>uniforme</em> (cioè non cambia) indipendentemente dalle istanziazioni dei tipi</li>
</ul>
</li>
</ul>
<h3 id="java-generics">Java Generics</h3>
<ul>
<li>I <strong>generici</strong> sono un meccanismo <em>compile-time</em> basato su <em>parametri di tipo</em> per implementare <em>polimorfismo parametrico</em></li>
<li><em>Classi/interfacce/metodi generici</em>: classi/interfacce/metodi parametrizzate su tipi, cioè che accettano tipi come parametri</li>
<li>Nessun impatto a run-time, per via dell’implementazione a “erasure”
<ul>
<li><code>javac</code> “compila via i generici”, quindi la JVM non li vede</li>
</ul>
</li>
</ul>
</section><section>
<h1 id="classi-generiche">Classi generiche</h1>
</section><section>
<h2 id="la-classe-generica-vectorx">La classe generica <code>Vector&lt;X&gt;</code></h2>
<ul>
<li><code>Vector</code> si dice che è un <strong>tipo parametrico</strong> (in quanto accetta il “parametro di tipo” <code>X</code>)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">X</span><span style="color:#000">&gt;</span>{ 
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// X è la type-variable, ossia il tipo degli elementi</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">Vector</span>() { <span style="color:#177500">/* ... */</span> }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">addElement</span>(<span style="color:#000">X</span> <span style="color:#000">e</span>) { <span style="color:#177500">/* ... */</span> } 	<span style="color:#177500">// Input di tipo X</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">X</span> <span style="color:#000">getElementAt</span>(<span style="color:#a90d91">int</span> <span style="color:#000">pos</span>) { <span style="color:#177500">/* ... */</span> } <span style="color:#177500">// Output di tipo X</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">int</span> <span style="color:#000">getLength</span>() { <span style="color:#177500">/* ... */</span> }
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">toString</span>() { <span style="color:#177500">/* ... */</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="uso-di-una-classe-generica">Uso di una classe generica</h2>
<ul>
<li>Si istanzia il <strong>parametro di tipo</strong> generico <code>X</code> in un tipo specifico (<strong>argomento di tipo</strong>), ad es. <code>Integer</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseVector</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">s</span>) {
</span></span><span style="display:flex;"><span>    	<span style="color:#177500">// Il tipo di vs è Vector&lt;String&gt;</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#177500">// Ma la sua classe è Vector&lt;X&gt;</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">String</span><span style="color:#000">&gt;</span> <span style="color:#000">vs</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">String</span><span style="color:#000">&gt;</span>(); 
</span></span><span style="display:flex;"><span>    	<span style="color:#000">vs</span>.<span style="color:#836c28">addElement</span>(<span style="color:#c41a16">"Prova"</span>);		
</span></span><span style="display:flex;"><span>    	<span style="color:#000">vs</span>.<span style="color:#836c28">addElement</span>(<span style="color:#c41a16">"di"</span>);		
</span></span><span style="display:flex;"><span>    	<span style="color:#000">vs</span>.<span style="color:#836c28">addElement</span>(<span style="color:#c41a16">"Vettore"</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">final</span> <span style="color:#000">String</span> <span style="color:#000">str</span> <span style="color:#000">=</span> <span style="color:#000">vs</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">0</span>) <span style="color:#000">+</span> <span style="color:#c41a16">" "</span> <span style="color:#000">+</span> 
</span></span><span style="display:flex;"><span>    		<span style="color:#000">vs</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">1</span>) <span style="color:#000">+</span> <span style="color:#c41a16">" "</span> <span style="color:#000">+</span>
</span></span><span style="display:flex;"><span>    		<span style="color:#000">vs</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">2</span>); <span style="color:#177500">// Nota, nessun cast!</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">str</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">vi</span><span style="color:#000">=</span><span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span>(); 
</span></span><span style="display:flex;"><span>    	<span style="color:#000">vi</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">10</span>); <span style="color:#177500">// Autoboxing</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#000">vi</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">20</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#000">vi</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">30</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">vi</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">0</span>) <span style="color:#000">+</span> <span style="color:#177500">// Unboxing </span>
</span></span><span style="display:flex;"><span>    		<span style="color:#000">vi</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">1</span>) <span style="color:#000">+</span>
</span></span><span style="display:flex;"><span>    		<span style="color:#000">vi</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">2</span>);
</span></span><span style="display:flex;"><span>    	<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">i</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="terminologia-e-elementi-essenziali">Terminologia, e elementi essenziali</h2>
<h3 id="data-una-classe-generica-cxy">Data una classe generica <code>C&lt;X,Y&gt;</code>..</h3>
<ul>
<li><code>C</code> è detta <strong>tipo parametrico</strong></li>
<li><code>X</code> e <code>Y</code> sono dette le sue <em><strong>type-variable</strong></em> o <strong>parametri di tipo</strong></li>
<li><code>X</code> e <code>Y</code> possono essere usati come un qualunque tipo dentro la classe (con alcune limitazioni che vedremo)</li>
</ul>
<h3 id="i-clienti-delle-classi-generiche">I clienti delle classi generiche</h3>
<ul>
<li>Devono usare <em>tipi specifici</em> ottenuti dai <em><strong>tipi generici</strong></em>, ovvero versioni “istanziate” delle classi generiche
<ul>
<li><code>C&lt;String,Integer&gt;</code>, <code>C&lt;C&lt;Object,Object&gt;,Object&gt;</code></li>
<li>Non <code>C</code> senza parametri, altrimenti vengono segnalati dei warning</li>
</ul>
</li>
<li>Ogni type-variable va sostituita con un tipo effettivo, ossia con un <em><strong>argomento di tipo</strong></em>, che può essere
<ul>
<li>una classe (non-generica), p.e. <code>Object</code>, <code>String</code>,..</li>
<li>una type-variable definita, p.e. <code>X,Y</code> (usate dentro la classe <code>C&lt;X,Y&gt;</code>)</li>
<li>un tipo generico completamente istanziato, p.e. <code>C&lt;Object,Object&gt;</code></li>
<li>..o  parzialmente istanziato, p.e. <code>C&lt;Object,X&gt;</code> (in <code>C&lt;X,Y&gt;</code>)</li>
<li><em>NON con un tipo primitivo</em></li>
</ul>
</li>
</ul>
</section><section>
<h2 id="implementazione-di-vector-pt-1">Implementazione di <code>Vector</code> pt 1</h2>
<ul>
<li>Nota: in Java NON si può istanziare un array di tipo generico: <code>new X[10]</code> (errore statico)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">X</span><span style="color:#000">&gt;</span> {
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">final</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">int</span> <span style="color:#000">INITIAL_SIZE</span> <span style="color:#000">=</span> <span style="color:#000">10</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#000">Object</span><span style="color:#000">[]</span> <span style="color:#000">elements</span>; 	<span style="color:#177500">// No X[], devo usare Object[]!!</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">int</span> <span style="color:#000">size</span>;		
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">Vector</span>() {		
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Object</span><span style="color:#000">[</span><span style="color:#000">INITIAL_SIZE</span><span style="color:#000">]</span>; <span style="color:#177500">// Object[]</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span> <span style="color:#000">=</span> <span style="color:#000">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">void</span> <span style="color:#000">addElement</span>(<span style="color:#000">X</span> <span style="color:#000">e</span>) {	<span style="color:#177500">// Tutto come atteso</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">if</span> (<span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span> <span style="color:#000">==</span> <span style="color:#000">elements</span>.<span style="color:#836c28">length</span>) {
</span></span><span style="display:flex;"><span>    	    <span style="color:#a90d91">this</span>.<span style="color:#836c28">expand</span>();	
</span></span><span style="display:flex;"><span>    	}
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span><span style="color:#000">[</span><span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span><span style="color:#000">]</span> <span style="color:#000">=</span> <span style="color:#000">e</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">size</span><span style="color:#000">++</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    ...
</span></span></code></pre></div></section><section>
<h2 id="implementazione-di-vector-pt-2">Implementazione di <code>Vector</code> pt 2</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">X</span> <span style="color:#000">getElementAt</span>(<span style="color:#a90d91">int</span> <span style="color:#000">position</span>) {  
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">return</span> (<span style="color:#000">X</span>)<span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span><span style="color:#000">[</span><span style="color:#000">position</span><span style="color:#000">]</span>; <span style="color:#177500">// Conversione a X</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#177500">// Genera un unchecked warning!</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">void</span> <span style="color:#000">expand</span>() {	
</span></span><span style="display:flex;"><span>    	<span style="color:#177500">// Ancora Object[]</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#000">Object</span><span style="color:#000">[]</span> <span style="color:#000">newElements</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Object</span><span style="color:#000">[</span><span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span>.<span style="color:#836c28">length</span><span style="color:#000">*</span><span style="color:#000">2</span><span style="color:#000">]</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">for</span> (<span style="color:#a90d91">int</span> <span style="color:#000">i</span><span style="color:#000">=</span><span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span>.<span style="color:#836c28">length</span>; <span style="color:#000">i</span><span style="color:#000">++</span>){
</span></span><span style="display:flex;"><span>    	    <span style="color:#000">newElements</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">]</span> <span style="color:#000">=</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span><span style="color:#000">[</span><span style="color:#000">i</span><span style="color:#000">]</span>;
</span></span><span style="display:flex;"><span>    	}
</span></span><span style="display:flex;"><span>    	<span style="color:#a90d91">this</span>.<span style="color:#836c28">elements</span> <span style="color:#000">=</span> <span style="color:#000">newElements</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// getLength() e toString() inalterate</span>
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="la-classe-generica-pairxy">La classe generica <code>Pair&lt;X,Y&gt;</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">X</span>, <span style="color:#000">Y</span><span style="color:#000">&gt;</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#a90d91">final</span> <span style="color:#000">X</span> <span style="color:#000">first</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">private</span> <span style="color:#a90d91">final</span> <span style="color:#000">Y</span> <span style="color:#000">second</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">Pair</span>(<span style="color:#a90d91">final</span> <span style="color:#000">X</span> <span style="color:#000">first</span>, <span style="color:#a90d91">final</span> <span style="color:#000">Y</span> <span style="color:#000">second</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span>.<span style="color:#836c28">first</span> <span style="color:#000">=</span> <span style="color:#000">first</span>;
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">this</span>.<span style="color:#836c28">second</span> <span style="color:#000">=</span> <span style="color:#000">second</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">X</span> <span style="color:#000">getFirst</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">first</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">Y</span> <span style="color:#000">getSecond</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">second</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#000">String</span> <span style="color:#000">toString</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">return</span> <span style="color:#c41a16">"&lt;"</span> <span style="color:#000">+</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">first</span> <span style="color:#000">+</span> <span style="color:#c41a16">","</span> <span style="color:#000">+</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">second</span> <span style="color:#000">+</span> <span style="color:#c41a16">"&gt;"</span>;
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="uso-di-pairxy">Uso di <code>Pair&lt;X,Y&gt;</code></h2>
<div class="smaller">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UsePair</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">s</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">p</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Integer</span><span style="color:#000">&gt;</span>(<span style="color:#c41a16">"aa"</span>, <span style="color:#000">1</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#000">String</span> <span style="color:#000">fst</span> <span style="color:#000">=</span> <span style="color:#000">p</span>.<span style="color:#836c28">getFirst</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">int</span> <span style="color:#000">snd</span> <span style="color:#000">=</span> <span style="color:#000">p</span>.<span style="color:#836c28">getSecond</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">fst</span> <span style="color:#000">+</span> <span style="color:#c41a16">" "</span> <span style="color:#000">+</span> <span style="color:#000">snd</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Integer</span><span style="color:#000">&gt;&gt;</span> <span style="color:#000">v</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Integer</span><span style="color:#000">&gt;&gt;</span>();
</span></span><span style="display:flex;"><span>		<span style="color:#000">v</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Integer</span><span style="color:#000">&gt;</span>(<span style="color:#c41a16">"Prova"</span>, <span style="color:#000">1</span>));
</span></span><span style="display:flex;"><span>		<span style="color:#000">v</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Integer</span><span style="color:#000">&gt;</span>(<span style="color:#c41a16">"Vettore"</span>, <span style="color:#000">2</span>));
</span></span><span style="display:flex;"><span>		<span style="color:#a90d91">final</span> <span style="color:#000">String</span> <span style="color:#000">str</span> <span style="color:#000">=</span> <span style="color:#000">v</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">0</span>).<span style="color:#836c28">getFirst</span>() <span style="color:#000">+</span> <span style="color:#c41a16">" "</span> <span style="color:#000">+</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000">v</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">1</span>).<span style="color:#836c28">getFirst</span>(); <span style="color:#177500">// Nota, nessun cast!</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">str</span>);
</span></span><span style="display:flex;"><span>		<span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">v</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></div>
</section><section>
<h2 id="inferenza-dei-parametri">Inferenza dei parametri</h2>
<h3 id="un-problema-sintattico-dei-generici">Un problema sintattico dei generici</h3>
<ul>
<li>Tendono a rendere il codice più pesante (“verbose”)</li>
<li>Obbligano a scrivere i parametri anche dove ovvi, con ripetizioni</li>
</ul>
<h3 id="lalgoritmo-di-type-inference-nel-compilatore">L’algoritmo di <em>type-inference</em> nel compilatore</h3>
<ul>
<li>Nella <code>new</code> si possono tentare di omettere i parametri (istanziazione delle type-variable), indicando il <em>“diamond symbol”</em> <code>&lt;&gt;</code></li>
<li>Il compilatore cerca di capire quali siano questi parametri guardando gli argomenti della <code>new</code> e l’eventuale contesto dentro il quale la <code>new</code> è posizionata, per esempio, se assegnata ad una variabile</li>
<li>Nel raro caso in cui non ci riuscisse, segnalerebbe un errore a tempo di compilazione.. quindi tanto vale provare!</li>
<li>Ricordarsi <code>&lt;&gt;</code>, altrimenti viene confuso con un <em><strong>raw type</strong></em>, un meccanismo usato per gestire il legacy con le versioni precedenti di Java</li>
</ul>
<h3 id="la-local-variable-type-inference-var">La local variable type inference (<code>var</code>)</h3>
<ul>
<li>in genere è alternativa al simbolo <code>&lt;&gt;</code></li>
</ul>
</section><section>
<h2 id="esempi-di-inferenza">Esempi di inferenza</h2>
<div class="smaller">
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UsePair2</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">s</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// Parametri in new Vector() inferiti dal tipo della variabile</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Integer</span><span style="color:#000">&gt;&gt;</span> <span style="color:#000">v</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// Parametri in new Pair(..) inferiti dal tipo degli argomenti</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">v</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#c41a16">"Prova"</span>, <span style="color:#000">1</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#000">v</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#c41a16">"Vettore"</span>, <span style="color:#000">2</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">v1second</span> <span style="color:#000">=</span> <span style="color:#000">v</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">1</span>).<span style="color:#836c28">getSecond</span>(); <span style="color:#177500">// Nota, nessun cast!</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">String</span> <span style="color:#000">str</span> <span style="color:#000">=</span> <span style="color:#000">v</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">0</span>).<span style="color:#836c28">getFirst</span>() <span style="color:#000">+</span> <span style="color:#c41a16">" "</span> <span style="color:#000">+</span> <span style="color:#000">v1second</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">str</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">v</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></div>
</section><section>
<h2 id="conseguenze-delluso-dei-generici">Conseguenze dell’uso dei generici</h2>
<p>Coi generici, Java diventa un linguaggio molto più espressivo!</p>
<ul>
<li>Il linguaggio risulta più sofisticato, e quindi più espressivo, ma anche più complesso</li>
<li>Codice più sicuro (safe) – il compilatore segnala errori difficili da trovare altrimenti</li>
<li><em>Maggiore riusabilità</em></li>
<li>Se ben usati, rendono il codice più comprensibile</li>
<li>Se non ben usati, possono minare la comprensibilità del software</li>
</ul>
</section><section>
<h1 id="interfacce-generiche">Interfacce generiche</h1>
</section><section>
<h2 id="interfacce-generiche-1">Interfacce generiche</h2>
<h3 id="cosa-è-una-interfaccia-generica">Cosa è una interfaccia generica</h3>
<ul>
<li>È una interfaccia che dichiara parametri di tipo: <code>interface I&lt;X,Y&gt; { ... }</code></li>
<li>I parametri di tipo compaiono nei metodi definiti dall’interfaccia</li>
<li>Quando una classe la implementa deve istanziare i parametri di tipo <!-- (o assegnarle ad altre type-variable se essa stessa è generica) --></li>
</ul>
<h3 id="utilizzi">Utilizzi</h3>
<p>Per creare <em>contratti uniformi rispetto ai tipi utilizzati</em></p>
<h3 id="un-esempio-notevole-gli-iteratori">Un esempio notevole, gli <strong>iteratori</strong></h3>
<ul>
<li>Un <em>iteratore</em> è un oggetto usato per accedere ad una sequenza di elementi
<ul>
<li>Ne vedremo ora una versione semplificata – diversa da quella delle librerie Java</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="linterfaccia-iterator">L’interfaccia <code>Iterator</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.iterators</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">interface</span> <span style="color:#3f6e75">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">E</span><span style="color:#000">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#177500">/*
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * Restituisce il prossimo elemento dell'iterazione
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     *
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * Nota: non è noto cosa succede se si chiama next()
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     * quando hasNext() ha dato esito falso
</span></span></span><span style="display:flex;"><span><span style="color:#177500">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">E</span> <span style="color:#000">next</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// dice se vi saranno altri elementi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">boolean</span> <span style="color:#000">hasNext</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="implementazione-1-intrangeiterator">Implementazione 1: <code>IntRangeIterator</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.iterators</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#177500">/* Itera tutti i numeri interi fra 'start' e 'stop' inclusi */</span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">IntRangeIterator</span> <span style="color:#a90d91">implements</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">int</span> <span style="color:#000">current</span>; <span style="color:#177500">// valore corrente</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">stop</span>; <span style="color:#177500">// valore finale</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">IntRangeIterator</span>(<span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">start</span>, <span style="color:#a90d91">final</span> <span style="color:#a90d91">int</span> <span style="color:#000">stop</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">this</span>.<span style="color:#836c28">current</span> <span style="color:#000">=</span> <span style="color:#000">start</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">this</span>.<span style="color:#836c28">stop</span> <span style="color:#000">=</span> <span style="color:#000">stop</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">Integer</span> <span style="color:#000">next</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">current</span><span style="color:#000">++</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">hasNext</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">current</span> <span style="color:#000">&lt;=</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">stop</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="implementazione-2-vectoriterator">Implementazione 2: <code>VectorIterator</code></h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.iterators</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#177500">/* Itera tutti gli elementi di un Vector */</span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">VectorIterator</span><span style="color:#000">&lt;</span><span style="color:#000">E</span><span style="color:#000">&gt;</span> <span style="color:#a90d91">implements</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">E</span><span style="color:#000">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">E</span><span style="color:#000">&gt;</span> <span style="color:#000">vector</span>; <span style="color:#177500">// Vettore da iterare</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">int</span> <span style="color:#000">current</span>; <span style="color:#177500">// Posizione nel vettore</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">VectorIterator</span>(<span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">E</span><span style="color:#000">&gt;</span> <span style="color:#000">vector</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">this</span>.<span style="color:#836c28">vector</span> <span style="color:#000">=</span> <span style="color:#000">vector</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">this</span>.<span style="color:#836c28">current</span> <span style="color:#000">=</span> <span style="color:#000">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">E</span> <span style="color:#000">next</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">vector</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#a90d91">this</span>.<span style="color:#836c28">current</span><span style="color:#000">++</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">boolean</span> <span style="color:#000">hasNext</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">vector</span>.<span style="color:#836c28">getLength</span>() <span style="color:#000">&gt;</span> <span style="color:#a90d91">this</span>.<span style="color:#836c28">current</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="useiterators-nota-laccesso-uniforme"><code>UseIterators</code>: nota l’accesso uniforme!</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.iterators</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.Calendar</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.GregorianCalendar</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseIterators</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">s</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Calendar</span><span style="color:#000">&gt;</span> <span style="color:#000">vector</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#000">vector</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">GregorianCalendar</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#000">vector</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">GregorianCalendar</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// creo 2 iteratori</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">iterator1</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">IntRangeIterator</span>(<span style="color:#000">5</span>, <span style="color:#000">10</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">Calendar</span><span style="color:#000">&gt;</span> <span style="color:#000">iterator2</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">VectorIterator</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#000">vector</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// ne stampo il contenuto</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">printAll</span>(<span style="color:#000">iterator1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">printAll</span>(<span style="color:#000">iterator2</span>); <span style="color:#177500">// Notare l'accesso uniforme! È uguale per Integer e Calendar</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">static</span> <span style="color:#000">&lt;</span><span style="color:#000">X</span><span style="color:#000">&gt;</span> <span style="color:#a90d91">void</span> <span style="color:#000">printAll</span>(<span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">X</span><span style="color:#000">&gt;</span> <span style="color:#000">iterator</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">while</span> (<span style="color:#000">iterator</span>.<span style="color:#836c28">hasNext</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Elemento : "</span> <span style="color:#000">+</span> <span style="color:#000">iterator</span>.<span style="color:#836c28">next</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h1 id="metodi-generici">Metodi generici</h1>
</section><section>
<h2 id="metodi-generici-1">Metodi generici</h2>
<h3 id="metodo-generico">Metodo generico</h3>
<p>Un metodo che lavora su qualche argomento e/o valore di ritorno in modo independente dal suo tipo effettivo. Tale tipo viene quindi astratto in una type-variable del metodo.</p>
<h3 id="sintassi">Sintassi</h3>
<ul>
<li>definizione: <code>&lt;X1, ..., Xn&gt; ReturnType nomeMetodo(ArgType1 argName1, ...) { ... }</code></li>
<li>chiamata: <code>receiver.&lt;X1, ..., Xn&gt;nomeMetodo(ArgType1 argName1, ...)</code></li>
<li>chiamata con inferenza (uso tipico): <code>receiver.nomeMetodo(ArgType1 argName1, ...)</code></li>
</ul>
<h3 id="generici-a-livello-di-classe-e-metodo">Generici a livello di classe e metodo</h3>
<ul>
<li>I <em>metodi istanza</em> possono vedere i parametri di tipo della classe che li ospita</li>
<li>I <em>metodi <code>static</code></em> <strong>non</strong> possono vedere i parametri di tipo della classe che li ospita
<ul>
<li>in quanto non legati ad una istanza, ma alla classe stessa</li>
</ul>
</li>
<li>Entrambi i tipi di metodi possono essere generici, dichiarando le proprie variabili di tipo,
che avranno visibilità solo all’interno del metodo stesso
<ul>
<li>È molto più frequente vedere metodi <code>static</code> generici</li>
<li>In effetti tipicamente i metodi istanza lavorano tipicamente usando i generici della classe</li>
</ul>
</li>
</ul>
</section><section>
<h2 id="definizione-di-un-metodo-generico-static-e-suo-utilizzo">Definizione di un metodo generico <code>static</code> e suo utilizzo</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.iterators</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.Calendar</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">java.util.GregorianCalendar</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">UseIterators2</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">&lt;</span><span style="color:#000">E</span><span style="color:#000">&gt;</span> <span style="color:#a90d91">void</span> <span style="color:#000">printAll</span>(<span style="color:#a90d91">final</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">E</span><span style="color:#000">&gt;</span> <span style="color:#000">iterator</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">while</span> (<span style="color:#000">iterator</span>.<span style="color:#836c28">hasNext</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Elemento : "</span> <span style="color:#000">+</span> <span style="color:#000">iterator</span>.<span style="color:#836c28">next</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>(<span style="color:#000">String</span><span style="color:#000">[]</span> <span style="color:#000">s</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">iterator</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">IntRangeIterator</span>(<span style="color:#000">5</span>, <span style="color:#000">10</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">LList</span><span style="color:#000">&lt;</span><span style="color:#000">String</span><span style="color:#000">&gt;</span> <span style="color:#000">list</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">LList</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#c41a16">"a"</span>, <span style="color:#a90d91">new</span> <span style="color:#000">LList</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#c41a16">"b"</span>, <span style="color:#a90d91">new</span> <span style="color:#000">LList</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#c41a16">"c"</span>, <span style="color:#a90d91">new</span> <span style="color:#000">LList</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#c41a16">"d"</span>, <span style="color:#a90d91">null</span>))));
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">String</span><span style="color:#000">&gt;</span> <span style="color:#000">iterator2</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">LListIterator</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#000">list</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Calendar</span><span style="color:#000">&gt;</span> <span style="color:#000">vector</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#000">vector</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">GregorianCalendar</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#000">vector</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">GregorianCalendar</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#000">vector</span>.<span style="color:#836c28">addElement</span>(<span style="color:#a90d91">new</span> <span style="color:#000">GregorianCalendar</span>());
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">Calendar</span><span style="color:#000">&gt;</span> <span style="color:#000">iterator3</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">VectorIterator</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#000">vector</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// con inferenza:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">UseIterators2</span>.<span style="color:#836c28">printAll</span>(<span style="color:#000">iterator</span>); <span style="color:#177500">// Equivale a: UseIterators2.&lt;Integer&gt;printAll(iterator)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">UseIterators2</span>.<span style="color:#836c28">printAll</span>(<span style="color:#000">iterator2</span>); <span style="color:#177500">// Equivale a: UseIterators2.&lt;String&gt;printAll(iterator)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">UseIterators2</span>.<span style="color:#836c28">printAll</span>(<span style="color:#000">iterator3</span>); <span style="color:#177500">// Equivale a: UseIterators2.&lt;Calendar&gt;printAll(iterator)</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="definizione-di-metodi-generico-istanza-e-loro-utilizzo">Definizione di metodi generico <em>istanza</em> e loro utilizzo</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.iterators</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">PairReplacer</span><span style="color:#000">&lt;</span><span style="color:#000">X</span>, <span style="color:#000">Y</span><span style="color:#000">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">private</span> <span style="color:#a90d91">final</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">X</span>, <span style="color:#000">Y</span><span style="color:#000">&gt;</span> <span style="color:#000">pair</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">PairReplacer</span>(<span style="color:#a90d91">final</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">X</span>, <span style="color:#000">Y</span><span style="color:#000">&gt;</span> <span style="color:#000">pair</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">this</span>.<span style="color:#836c28">pair</span> <span style="color:#000">=</span> <span style="color:#000">pair</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">&lt;</span><span style="color:#000">Z</span><span style="color:#000">&gt;</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">Z</span>, <span style="color:#000">Y</span><span style="color:#000">&gt;</span> <span style="color:#000">replaceFirst</span>(<span style="color:#a90d91">final</span> <span style="color:#000">Z</span> <span style="color:#000">newFirst</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#000">newFirst</span>, <span style="color:#a90d91">this</span>.<span style="color:#836c28">pair</span>.<span style="color:#836c28">getSecond</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#000">&lt;</span><span style="color:#000">Z</span><span style="color:#000">&gt;</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">X</span>, <span style="color:#000">Z</span><span style="color:#000">&gt;</span> <span style="color:#000">replaceSecond</span>(<span style="color:#a90d91">final</span> <span style="color:#000">Z</span> <span style="color:#000">newSecond</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#a90d91">this</span>.<span style="color:#836c28">pair</span>.<span style="color:#836c28">getFirst</span>(), <span style="color:#000">newSecond</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">replacer</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">PairReplacer</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#a90d91">new</span> <span style="color:#000">Pair</span><span style="color:#000">&lt;&gt;</span>(<span style="color:#c41a16">"Hello"</span>, <span style="color:#000">42</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#a90d91">var</span> <span style="color:#000">newFirstPair</span> <span style="color:#000">=</span> <span style="color:#000">replacer</span>.<span style="color:#836c28">replaceFirst</span>(<span style="color:#000">3</span>.<span style="color:#836c28">14</span>); <span style="color:#177500">// Con inferenza, uso tipico</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Replaced First: "</span> <span style="color:#000">+</span> <span style="color:#000">newFirstPair</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">Pair</span><span style="color:#000">&lt;</span><span style="color:#000">String</span>, <span style="color:#000">Boolean</span><span style="color:#000">&gt;</span> <span style="color:#000">newSecondPair</span> <span style="color:#000">=</span> <span style="color:#000">replacer</span>.<span style="color:#000">&lt;</span><span style="color:#000">Boolean</span><span style="color:#000">&gt;</span><span style="color:#000">replaceSecond</span>(<span style="color:#a90d91">true</span>); <span style="color:#177500">// Senza inferenza</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#c41a16">"Replaced Second: "</span> <span style="color:#000">+</span> <span style="color:#000">newSecondPair</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h1 id="covarianza-contravarianza-wildcards">Covarianza, contravarianza, wildcards</h1>
</section><section>
<h2 id="java-wildcards">Java Wildcards</h2>
<h3 id="osservazione">Osservazione</h3>
<ul>
<li>In generale, dato un tipo <code>C&lt;T&gt;</code>, se <code>S</code> è sottotipo di <code>T</code>, <strong>non</strong> vale che <code>C&lt;S&gt;</code> è sottotipo di <code>C&lt;T&gt;</code>
<ul>
<li>Esempio: <code>Student extends Person</code> non implica che <code>Vector&lt;Student&gt;</code> estenda <code>Vector&lt;Person&gt;</code>
<ul>
<li>Se lo estendesse, ogni chiamata a metodi di <code>Vector&lt;Person&gt;</code> sarebbe valida anche per <code>Vector&lt;Student&gt;</code></li>
<li>Incluso il metodo <code>add(Person p)</code></li>
<li>Ma se posso aggiungere un <code>Person</code> ad un <code>Vector&lt;Student&gt;</code>, starei violando la sicurezza dei tipi!</li>
</ul>
</li>
</ul>
</li>
<li>Questo comportamento è detto <strong>invarianza</strong> dei generici in Java</li>
<li>A volte è utile poter esprimere relazioni di sottotipo fra tipi generici
<ul>
<li>Sia del tipo “qualunque sottotipo di T” (<em>covarianza</em>), tipicamente in lettura
<ul>
<li>Ad esempio, un <code>Vector</code> di un sottotipo non noto di <code>Number</code>
<ul>
<li>Non potrò aggiungere nulla, ma potrò leggere <code>Number</code></li>
</ul>
</li>
</ul>
</li>
<li>Sia del tipo “qualunque supertipo di T” (<em>contravarianza</em>), tipicamente in scrittura
<ul>
<li>Ad esempio, un <code>Vector</code> di un supertipo non noto di <code>Double</code>
<ul>
<li>Potrò aggiungere <code>Double</code>, ma non potrò leggere nulla di più specifico di <code>Object</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="java-wildcards-1">Java Wildcards</h3>
<ul>
<li>Un meccanismo che fornisce dei nuovi tipi, chiamati Wildcards</li>
<li>Simili a interfacce (non generano oggetti, descrivono solo contratti)</li>
<li>Generalmente usati come tipo dell’argomento di metodi</li>
</ul>
</section><section>
<h2 id="java-wildcards-2">Java Wildcards</h2>
<h3 id="3-tipi-di-wildcard">3 tipi di wildcard</h3>
<ul>
<li>Bounded (covariante): <code>C&lt;? extends T&gt;</code>
<ul>
<li>accetta un qualunque <code>C&lt;S&gt;</code> con <code>S</code> sottotipo di <code>T</code></li>
</ul>
</li>
<li>Bounded (contravariante): <code>C&lt;? super T&gt;</code>
<ul>
<li>accetta un qualunque <code>C&lt;S&gt;</code> con <code>S</code> supertipo di <code>T</code></li>
</ul>
</li>
<li>Unbounded: <code>C&lt;?&gt;</code>
<ul>
<li>accetta un qualunque <code>C&lt;S&gt;</code></li>
</ul>
</li>
</ul>
<h3 id="uso-delle-librerie-che-dichiarano-tipi-wildcard"><em>Uso</em> delle librerie che dichiarano tipi wildcard</h3>
<ul>
<li>Piuttosto semplice, basta passare un argomento compatibile o si ha un errore a tempo di compilazione</li>
</ul>
<h3 id="progettazione-di-librerie-che-usano-tipi-wildcard"><em>Progettazione</em> di librerie che usano tipi wildcard</h3>
<ul>
<li>Molto avanzato: le wildcard pongono limiti alle operazioni che uno può eseguire, derivanti dal principio di sostituibilità</li>
</ul>
</section><section>
<h2 id="esempio-wildcard-1-unbounded">Esempio Wildcard 1 (unbounded)</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.wildcard</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">it.unibo.generics.iterators.IntRangeIterator</span>;
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">it.unibo.generics.iterators.Iterator</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">Wildcard</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// Metodo che usa la wildcard</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">printAll</span>(<span style="color:#000">Iterator</span><span style="color:#000">&lt;?&gt;</span> <span style="color:#000">it</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">while</span> (<span style="color:#000">it</span>.<span style="color:#836c28">hasNext</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">it</span>.<span style="color:#836c28">next</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// Analoga versione con metodo generico</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">&lt;</span><span style="color:#000">T</span><span style="color:#000">&gt;</span> <span style="color:#a90d91">void</span> <span style="color:#000">printAll2</span>(<span style="color:#000">Iterator</span><span style="color:#000">&lt;</span><span style="color:#000">T</span><span style="color:#000">&gt;</span> <span style="color:#000">it</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">while</span> (<span style="color:#000">it</span>.<span style="color:#836c28">hasNext</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">it</span>.<span style="color:#836c28">next</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// Quale versione preferibile?</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#000">Wildcard</span>.<span style="color:#836c28">printAll</span>(<span style="color:#a90d91">new</span> <span style="color:#000">IntRangeIterator</span>(<span style="color:#000">1</span>, <span style="color:#000">5</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#000">Wildcard</span>.<span style="color:#836c28">printAll2</span>(<span style="color:#a90d91">new</span> <span style="color:#000">IntRangeIterator</span>(<span style="color:#000">1</span>, <span style="color:#000">5</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#000">Wildcard</span>.<span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span><span style="color:#000">printAll2</span>(<span style="color:#a90d91">new</span> <span style="color:#000">IntRangeIterator</span>(<span style="color:#000">1</span>, <span style="color:#000">5</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="esempio-wildcard-2-bounded">Esempio Wildcard 2 (bounded)</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.wildcard</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">it.unibo.generics.generics.Vector</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">Wildcard2</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// Metodo che usa la wildcard</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">toIntVector</span>(<span style="color:#000">Vector</span><span style="color:#000">&lt;?</span> <span style="color:#a90d91">extends</span> <span style="color:#000">Number</span><span style="color:#000">&gt;</span> <span style="color:#000">vec</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">out</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">for</span>(<span style="color:#a90d91">int</span> <span style="color:#000">i</span> <span style="color:#000">=</span> <span style="color:#000">0</span>; <span style="color:#000">i</span> <span style="color:#000">&lt;</span> <span style="color:#000">vec</span>.<span style="color:#836c28">getLength</span>(); <span style="color:#000">i</span><span style="color:#000">++</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#177500">// Si noti accesso al metodo intValue() del contratto di Number</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">out</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">vec</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">i</span>).<span style="color:#836c28">intValue</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#000">out</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">main</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Double</span><span style="color:#000">&gt;</span> <span style="color:#000">vd</span> <span style="color:#000">=</span> <span style="color:#a90d91">new</span> <span style="color:#000">Vector</span><span style="color:#000">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#000">vd</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">1</span>.<span style="color:#836c28">5</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">vd</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">6</span>.<span style="color:#836c28">7</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">Vector</span><span style="color:#000">&lt;</span><span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">vi</span> <span style="color:#000">=</span> <span style="color:#000">toIntVector</span>(<span style="color:#000">vd</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#000">System</span>.<span style="color:#836c28">out</span>.<span style="color:#836c28">println</span>(<span style="color:#000">vi</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">0</span>) <span style="color:#000">+</span> <span style="color:#c41a16">", "</span> <span style="color:#000">+</span> <span style="color:#000">vi</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">1</span>));
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// var vd2 = toIntVector(new Vector&lt;String&gt;()); // ERROR: method not applicable</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="esempio-wildcard-3-bounded-limitazioni">Esempio Wildcard 3 (bounded, limitazioni)</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="nohighlight" data-noescape=""><span style="display:flex;"><span><span style="color:#a90d91">package</span> <span style="color:#000">it.unibo.generics.wildcard</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">import</span> <span style="color:#000">it.unibo.generics.generics.Vector</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a90d91">public</span> <span style="color:#a90d91">class</span> <span style="color:#3f6e75">Wildcard3</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#177500">// Le wildcard pongono limiti sulle operazioni eseguibili</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#a90d91">void</span> <span style="color:#000">addElementToVector</span>(<span style="color:#000">Vector</span><span style="color:#000">&lt;?</span> <span style="color:#a90d91">extends</span> <span style="color:#000">Number</span><span style="color:#000">&gt;</span> <span style="color:#000">vec</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// Per Vector&lt;T&gt; covariante non possiamo invocare metodi che accettano T in input</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">final</span> <span style="color:#000">Number</span> <span style="color:#000">n</span> <span style="color:#000">=</span> <span style="color:#000">vec</span>.<span style="color:#836c28">getElementAt</span>(<span style="color:#000">0</span>); <span style="color:#177500">// questo è ok</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Number</span> <span style="color:#000">toAdd</span> <span style="color:#000">=</span> <span style="color:#000">n</span>.<span style="color:#836c28">doubleValue</span>() <span style="color:#000">+</span> <span style="color:#000">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// vec.addElement(toAdd); // ERROR!</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a90d91">public</span> <span style="color:#a90d91">static</span> <span style="color:#000">Number</span> <span style="color:#000">returnFirstNumber</span>(<span style="color:#000">Vector</span><span style="color:#000">&lt;?</span> <span style="color:#a90d91">super</span> <span style="color:#000">Integer</span><span style="color:#000">&gt;</span> <span style="color:#000">vec</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// Per Vector&lt;T&gt; contravariante non possiamo invocare metodi che restituiscono T in output</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">vec</span>.<span style="color:#836c28">addElement</span>(<span style="color:#000">Integer</span>.<span style="color:#836c28">valueOf</span>(<span style="color:#000">7</span>)); <span style="color:#177500">// questo è ok</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">Number</span> <span style="color:#000">out</span> <span style="color:#000">=</span> <span style="color:#a90d91">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#177500">// out = vec.getElementAt(0); // ERROR!</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a90d91">return</span> <span style="color:#000">out</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></section><section>
<h2 id="interpretazione-come-input--output">Interpretazione come Input / Output</h2>
<p>Un modo più intuitivo di interpretare le wildcard è quello di considerare i tipi generici come
<em>produttori</em> o <em>consumatori</em> di valori del tipo specificato.</p>
<ul>
<li>In diversi linguaggi (fra cui C# e Kotlin) questo concetto è formalizzato con le keywords <code>in</code> e <code>out</code>.
<ul>
<li>In Kotlin o C#, ad esempio, si dichiara la covarianza di un tipo generico <code>C</code> con <code>C&lt;out T&gt;</code>, e la contravarianza con <code>C&lt;in T&gt;</code>.</li>
<li>L’equivalente in Java sarebbe <code>C&lt;? extends T&gt;</code> per la covarianza e <code>C&lt;? super T&gt;</code> per la contravarianza.</li>
</ul>
</li>
</ul>
<h3 id="ne-consegue-che">Ne consegue che:</h3>
<ul>
<li><code>Vector&lt;? extends Number&gt;</code> si può leggere “<code>Vector</code> che può <strong>fornire</strong> ma <em>non accettare</em> <code>Number</code>”
<ul>
<li>come per <code>Vector&lt;out Number&gt;</code> in Kotlin o C#, dove la keyword <code>out</code> è usata per specificare parametri di tipo covarianti</li>
</ul>
</li>
<li><code>Vector&lt;? super Number&gt;</code> si può leggere “<code>Vector</code> che può <strong>accettare</strong> ma <em>non fornire</em> <code>Number</code>”
<ul>
<li>come per <code>Vector&lt;in Number&gt;</code> in Kotlin o C#, dove la keyword <code>in</code> è usata per specificare parametri di tipo contravarianti</li>
</ul>
</li>
</ul>
</section><section>
<h1 id="generici-1">Generici</h1>
<h4 id="progettazione-e-sviluppo-del-software">Progettazione e Sviluppo del Software</h4>
<h4 id="cdl-tecnologie-dei-sistemi-informatici">C.D.L. Tecnologie dei Sistemi Informatici</h4>
<h3 id="danilo-pianini"><a href="mailto:danilo.pianini@unibo.it">Danilo Pianini — <code>danilo.pianini@unibo.it</code></a></h3>
<h3 id="gianluca-aguzzi"><a href="mailto:gianluca.aguzzi@unibo.it">Gianluca Aguzzi — <code>gianluca.aguzzi@unibo.it</code></a></h3>
<h3 id="angelo-filaseta"><a href="mailto:angelo.filaseta@unibo.it">Angelo Filaseta — <code>angelo.filaseta@unibo.it</code></a></h3>
<p>Compiled on: 2025-10-30
 — <a href="?print-pdf&amp;pdfSeparateFragments=false"><i class="fa fa-print" aria-hidden="true"></i> versione stampabile</a></p>
<p><a href=".."><i class="fa fa-undo" aria-hidden="true"></i> back</a></p>
</section>

  


</div>
      

    </div>
<script type="text/javascript" src="/reveal-hugo/object-assign.js"></script>

<a href="/reveal-js/dist/print/" id="print-location" style="display: none;"></a>

<script type="application/json" id="reveal-hugo-site-params">{"custom_theme":"custom-theme.scss","custom_theme_compile":true,"custom_theme_options":{"enablesourcemap":true,"targetpath":"css/custom-theme.css"},"height":"900","highlight_theme":"default","history":true,"mermaid":[{"startOnLoad":false}],"slide_number":true,"theme":"white","transition":"slide","transition_speed":"fast","width":"1440"}</script>
<script type="application/json" id="reveal-hugo-page-params">null</script>

<script src="/reveal-js/dist/reveal.js"></script>


  
  
  <script type="text/javascript" src="/reveal-js/plugin/markdown/markdown.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/highlight/highlight.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/zoom/zoom.js"></script>
  
  <script type="text/javascript" src="/reveal-js/plugin/notes/notes.js"></script>
  
  
  <script type="text/javascript" src="/reveal-js/plugin/notes/notes.js"></script>




<script type="text/javascript">
  
  
  function camelize(map) {
    if (map) {
      Object.keys(map).forEach(function(k) {
        newK = k.replace(/(\_\w)/g, function(m) { return m[1].toUpperCase() });
        if (newK != k) {
          map[newK] = map[k];
          delete map[k];
        }
      });
    }
    return map;
  }

  var revealHugoDefaults = { center: true, controls: true, history: true, progress: true, transition: "slide" };

  var revealHugoPlugins = {
    plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealZoom ]
   };
  var revealHugoSiteParams = JSON.parse(document.getElementById('reveal-hugo-site-params').innerHTML);
  var revealHugoPageParams = JSON.parse(document.getElementById('reveal-hugo-page-params').innerHTML);
  
  var options = Object.assign({},
    camelize(revealHugoDefaults),
    camelize(revealHugoSiteParams),
    camelize(revealHugoPageParams),
    camelize(revealHugoPlugins));
  Reveal.initialize(options);
</script>







  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
    
  
  

  
  

  
    
  
  

  
  

  
  

  
    
  
  

  
  

  
  

  
    
  
  

  
    
  
  

  
  

  
  

  
  

  
    
  
  

  
  

  
  

  
  

  
    
  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  



  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.3/dist/mermaid.min.js"></script>
  <script>
    mermaid.initialize({"startOnLoad":false});

    let render = (event) => {
      let mermaidElems = event.currentSlide.querySelectorAll('.mermaid');
      if (!mermaidElems.length){
          return
      }
      mermaidElems.forEach(mermaidElem => {
          let processed = mermaidElem.getAttribute('data-processed');
          if (!processed){
              
              mermaid.init(undefined, mermaidElem);
          }
      });
    };
    
    render({currentSlide: Reveal.getCurrentSlide()});

    Reveal.on('slidechanged', render);
    Reveal.on('ready', render);
  </script>



    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
</script>

<script type="text/javascript" id="MathJax-script" async="" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>

<script>
  if (/.*?(\?|&)print-pdf/.test(window.location.toString())) {
      var ytVideos = document.getElementsByTagName("iframe")
      for (let i = 0; i < ytVideos.length; i++) {
          var videoFrame = ytVideos[i]
          var isYouTube = /^https?:\/\/(www.)youtube\.com\/.*/.test(videoFrame.src)
          if (isYouTube) {
              console.log(`Removing ${videoFrame.src}`)
              var parent = videoFrame.parentElement
              videoFrame.remove()
              var p = document.createElement('p')
              p.append(
                  document.createTextNode(
                      "There was an embedded video here, but it is disabled in the printed version of the slides."
                  )
              )
              p.append(document.createElement('br'))
              p.append(
                  document.createTextNode(
                      `Visit instead ${
                          videoFrame.src
                      } or ${
                          videoFrame.src.replace(
                              /(^https?:\/\/(www.)youtube\.com)\/(embed\/)(\w+).*/,
                              "https://www.youtube.com/watch?v=$4"
                          )
                      }`
                  )
              )
              parent.appendChild(p)
          }
      }
  }
</script>

    
  

</body></html>